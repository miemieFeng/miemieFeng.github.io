{
    "version": "https://jsonfeed.org/version/1",
    "title": "咩咩君 • All posts by \"群晖\" category",
    "description": "coding日常",
    "home_page_url": "http://miemieFeng.github.io",
    "items": [
        {
            "id": "http://miemiefeng.github.io/%E4%BD%BF%E7%94%A8%E9%BB%91%E7%BE%A4%E6%99%96%E6%90%AD%E5%BB%BA%E6%97%81%E8%B7%AF%E7%94%B1/",
            "url": "http://miemiefeng.github.io/%E4%BD%BF%E7%94%A8%E9%BB%91%E7%BE%A4%E6%99%96%E6%90%AD%E5%BB%BA%E6%97%81%E8%B7%AF%E7%94%B1/",
            "title": "使用黑群晖搭建旁路由",
            "date_published": "2022-02-09T01:41:28.000Z",
            "content_html": "<blockquote>\n<p>家里购置了 switch 自然是需要全家富强才可以更舒适的使用</p>\n</blockquote>\n<h3 id=\"一-安装虚拟机套件\"><a class=\"markdownIt-Anchor\" href=\"#一-安装虚拟机套件\">#</a> 一、安装虚拟机套件</h3>\n<p><strong>这里我选择安装旧版虚拟机套件，因为新版需要 vip 才可以开启 cpu 兼容</strong><br>\n<img data-src=\"https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/image-602efa6a1b774c4397f317bbb091fcc0.png\" alt=\"image-602efa6a1b774c4397f317bbb091fcc0\"><br>\n 可以看到我这里安装了 2.31 版</p>\n<h3 id=\"二-下载旁路由镜像\"><a class=\"markdownIt-Anchor\" href=\"#二-下载旁路由镜像\">#</a> 二、下载旁路由镜像</h3>\n<p><strong>这里我选择下载恩山大佬第一的镜像，下载地址 https://openwrt.mpdn.fun:8443</strong></p>\n<h3 id=\"三-导入镜像\"><a class=\"markdownIt-Anchor\" href=\"#三-导入镜像\">#</a> 三、导入镜像</h3>\n<p>打开虚拟机软件，选择新增，导入 pc 镜像<img data-src=\"https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116192456.png\" alt=\"20221116192456\"> 等待上传完毕即可</p>\n<h3 id=\"四-启动镜像\"><a class=\"markdownIt-Anchor\" href=\"#四-启动镜像\">#</a> 四、启动镜像</h3>\n<p>首先选择虚拟机 - 导入<br>\n<img data-src=\"https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116192548.png\" alt=\"20221116192548\"><br>\n 导入刚才上传的镜像<br>\n 1、然后启动并连接。在跳出来的窗口界面输入命令，vi etc/config/network ，修改一下软路由的 IP。<br>\n2、在 option ipaddr 后面把 IP 修改成为和主路由一个网段的，可以按 i 键进行修改，比如我设置成 192.1168。1.10，修改完后按 Esc 退出，接着输入命令 ：wq ，保存刚才的修改。<br>\n3、再输入 passwd 修改一下密码，修改的时候密码不会显示，不用担心，输完按回车就行，要连续输入两次。<br>\n4、最后输入命令 reboot 进行重启就 OK 了。<br>\n5、在浏览器输入刚才咱们修改过的 IP，这时候已经可以进入 Openwrt 的登陆界面了，填上自己设置的密码就可以进系统了</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116192621.png\" alt=\"20221116192621\"></p>\n<h3 id=\"五-openwrt系统配置\"><a class=\"markdownIt-Anchor\" href=\"#五-openwrt系统配置\">#</a> 五、Openwrt 系统配置</h3>\n<p>系统装完了，要想正常使用还得配置一下，找到左侧菜单 网络 — 接口，选择 LAN 的接口进行修改。<br>\n<img data-src=\"https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116192643.png\" alt=\"20221116192643\"><br>\n 网关和 dns 填自己的网关（忽略此接口处打上勾，不让旁路由提供 DHCP 服务，避免和主路由冲突。）<br>\n<img data-src=\"https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116192705.png\" alt=\"20221116192705\"></p>\n<h3 id=\"六-修改上网设备ip\"><a class=\"markdownIt-Anchor\" href=\"#六-修改上网设备ip\">#</a> 六、修改上网设备 ip</h3>\n<p>此时将上网设备的 ip 和 dns 改为我们旁路由的地址即可，我这里是改了小米路由器做二级路由</p>\n<blockquote>\n<p>此时连接了小米路由器的设备都可以通过旁路由来设置策略了</p>\n</blockquote>\n",
            "tags": [
                "旁路由"
            ]
        },
        {
            "id": "http://miemiefeng.github.io/%E8%A7%A3%E5%86%B3%E7%BE%A4%E8%BE%89%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%90%8Essh%E8%BF%9E%E6%8E%A5%E5%87%BA%E7%8E%B0connection%20is%20closed%20by%20foreign%20host/",
            "url": "http://miemiefeng.github.io/%E8%A7%A3%E5%86%B3%E7%BE%A4%E8%BE%89%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%90%8Essh%E8%BF%9E%E6%8E%A5%E5%87%BA%E7%8E%B0connection%20is%20closed%20by%20foreign%20host/",
            "title": "解决 fatal:unable to connect to gitee.com:gitee.com[0:180.97.125.228]：errno=Unknown error",
            "date_published": "2021-12-23T00:41:46.000Z",
            "content_html": "<h3 id=\"上次内网穿透后发现在家里一直无法通过穿透服务器连接群辉ssh\"><a class=\"markdownIt-Anchor\" href=\"#上次内网穿透后发现在家里一直无法通过穿透服务器连接群辉ssh\">#</a> 上次内网穿透后，发现在家里一直无法通过穿透服务器连接群辉 ssh</h3>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116194141.png\" alt=\"20221116194141\"></p>\n<h3 id=\"后来发现是被群辉拉入了黑名单解除就可以了\"><a class=\"markdownIt-Anchor\" href=\"#后来发现是被群辉拉入了黑名单解除就可以了\">#</a> 后来发现是被群辉拉入了黑名单，解除就可以了</h3>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116194201.png\" alt=\"20221116194201\"></p>\n<blockquote>\n<p>取消自动封锁，或者把 ip 移出来</p>\n</blockquote>\n",
            "tags": [
                "群晖"
            ]
        },
        {
            "id": "http://miemiefeng.github.io/%E9%BB%91%E7%BE%A4%E6%99%96frp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/",
            "url": "http://miemiefeng.github.io/%E9%BB%91%E7%BE%A4%E6%99%96frp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/",
            "title": "黑群晖frp内网穿透",
            "date_published": "2021-12-14T05:48:58.000Z",
            "content_html": "<blockquote>\n<p>前段时间闲来无事，吧家里的旧笔记本改造成了黑群晖.<br>\n 开通内网穿透踩了很多坑，特此记录一下</p>\n</blockquote>\n<p><strong>frp 分别有服务端 (frps) 和客户端 (frpc)</strong></p>\n<h2 id=\"一-下面先说服务端\"><a class=\"markdownIt-Anchor\" href=\"#一-下面先说服务端\">#</a> 一、下面先说服务端</h2>\n<p>因为是第一次操作，所以没有使用 docker 管理。有时间一定要换成 docker</p>\n<h4 id=\"1-首先下载frp根据自己的系统选择\"><a class=\"markdownIt-Anchor\" href=\"#1-首先下载frp根据自己的系统选择\">#</a> 1、首先下载 frp（根据自己的系统选择）</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/fatedier/frp/releases/download/v0.33.0/frp_0.33.0_linux_amd64.tar.gz</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-解压命令解压出来\"><a class=\"markdownIt-Anchor\" href=\"#2-解压命令解压出来\">#</a> 2、解压命令解压出来</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zxvf frp_0.33.0_linux_amd64.tar.gz</span><br></pre></td></tr></table></figure>\n<h4 id=\"3-进入-frp-目录\"><a class=\"markdownIt-Anchor\" href=\"#3-进入-frp-目录\">#</a> 3、进入 frp 目录</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd frp_0.33.0_linux_amd64</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-配置服务器端文件\"><a class=\"markdownIt-Anchor\" href=\"#4-配置服务器端文件\">#</a> 4、配置服务器端文件</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi frps.ini</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>下面我把配置文件贴出来</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[common]\t\t\t#必填</span><br><span class=\"line\">bind_port = 1231  \t\t#服务端口（可自定义）</span><br><span class=\"line\">vhost_http_port = 1232 \t\t#访问端口（可自定义）</span><br><span class=\"line\">dashboard_port = 7500 \t\t#dashboard 界面端口</span><br><span class=\"line\">dashboard_user = 账号\t\t#登录 dashboard 用户名</span><br><span class=\"line\">dashboard_pwd = 密码\t\t#登录 dashboard 密码</span><br><span class=\"line\">max_pool_count = 5\t\t#最大连接池数量</span><br><span class=\"line\">authentication_timeout = 900\t#超时验证时间</span><br><span class=\"line\">subdomain_host = 你的域名\t#自定义二级域名（这里我用了我另一个备案的域名）</span><br><span class=\"line\">[ssh]</span><br><span class=\"line\">listen_port = 6000 \t\t#访问端口</span><br><span class=\"line\">auth_token = 123321\t\t#用户身份认证</span><br></pre></td></tr></table></figure>\n<h4 id=\"6-启动服务器端frps测试启动\"><a class=\"markdownIt-Anchor\" href=\"#6-启动服务器端frps测试启动\">#</a> 6、启动服务器端 frps（测试启动）</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./frps -c ./frps.ini</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>如果没有报错，那么服务端的操作暂时完毕</p>\n</blockquote>\n<p>二、开始说客户端（群晖端）</p>\n<blockquote>\n<p>一开始群晖也是使用了和上边一样的操作，只是配置文件不同，后来发现一个弊端 ----&gt; 每次重启群晖后，frpc 不会自启动。或者因为不可抗力因素，frpc 关闭了很不方便</p>\n</blockquote>\n<h4 id=\"1-下载docker套件\"><a class=\"markdownIt-Anchor\" href=\"#1-下载docker套件\">#</a> 1、下载 docker 套件</h4>\n<p>首先我们打开套件中心，搜索 docker 并安装。docker 应该算是黑群晖必备套件我就不细说了</p>\n<h4 id=\"2-下载frp\"><a class=\"markdownIt-Anchor\" href=\"#2-下载frp\">#</a> 2、下载 frp</h4>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116194700.png\" alt=\"20221116194700\"></p>\n<h3 id=\"2-启动容器\"><a class=\"markdownIt-Anchor\" href=\"#2-启动容器\">#</a> 2、启动容器</h3>\n<p>映射 frpc 文件，容器内路径为 <code>/frp/frpc.ini</code> ，容器外路径随意，自己选</p>\n<h4 id=\"3-修改配置文件\"><a class=\"markdownIt-Anchor\" href=\"#3-修改配置文件\">#</a> 3、修改配置文件</h4>\n<p>一定要注意，我们的配置文件是 `frpc.ini，下面我把文件内容贴出来</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[common]</span><br><span class=\"line\">server_addr = 服务端ip</span><br><span class=\"line\">server_port = 端口设置</span><br><span class=\"line\">auth_token = 随便设置</span><br><span class=\"line\">pool_count = 1</span><br><span class=\"line\">[ssh]</span><br><span class=\"line\">type = tcp</span><br><span class=\"line\">local_ip = 本地群晖ip</span><br><span class=\"line\">local_port = 22</span><br><span class=\"line\">remote_port = 6000</span><br><span class=\"line\">use_compression = true</span><br><span class=\"line\">use_encryption = true</span><br><span class=\"line\">[qh]\t\t\t#如果有多个端口一定不能和下面的名字重复了</span><br><span class=\"line\">type = http</span><br><span class=\"line\">local_port = 5000</span><br><span class=\"line\">subdomain = qh\t\t#这里一定是写你的二级域名前缀（坑点）</span><br><span class=\"line\">[ql]</span><br><span class=\"line\">type = http</span><br><span class=\"line\">local_port = 5700</span><br><span class=\"line\">subdomain = ql</span><br><span class=\"line\">[nl]</span><br><span class=\"line\">type = http</span><br><span class=\"line\">local_port = 5703</span><br><span class=\"line\">subdomain = nl</span><br><span class=\"line\">[sn]</span><br><span class=\"line\">type = http</span><br><span class=\"line\">local_port = 8181</span><br><span class=\"line\">subdomain = sn</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h4 id=\"4-启动服务器端\"><a class=\"markdownIt-Anchor\" href=\"#4-启动服务器端\">#</a> 4、启动服务器端</h4>\n<p>群晖启动服务端，进入高级设置，选择停止后重启，并且一定要选择使用和 dockerhost 相同网络</p>\n<blockquote>\n<p>此时如果容器没有无限容器那么说明已经是链接成功了，可以访问刚才自己配的地址去看，一定是域名加端口号访问。除非像我一样在服务端使用 nginx 分别反向代理</p>\n</blockquote>\n<h2 id=\"三-服务端frp后台运行\"><a class=\"markdownIt-Anchor\" href=\"#三-服务端frp后台运行\">#</a> 三、服务端 frp 后台运行</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup ./frps -c ./frps.ini &amp;</span><br></pre></td></tr></table></figure>\n<p>最后贴上成果<br>\n<img data-src=\"https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116194719.png\" alt=\"20221116194719\"></p>\n",
            "tags": [
                "群晖"
            ]
        }
    ]
}