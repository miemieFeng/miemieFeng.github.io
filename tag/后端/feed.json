{
    "version": "https://jsonfeed.org/version/1",
    "title": "咩咩君 • All posts by \"后端\" tag",
    "description": "coding日常",
    "home_page_url": "http://miemieFeng.github.io",
    "items": [
        {
            "id": "http://miemiefeng.github.io/swagger2%20%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3%E6%95%B4%E7%90%86/",
            "url": "http://miemiefeng.github.io/swagger2%20%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3%E6%95%B4%E7%90%86/",
            "title": "swagger2 常用注解整理",
            "date_published": "2022-01-25T09:18:32.000Z",
            "content_html": "<blockquote>\n<p>最近用到 swagger 想着整理一下常用注解 (只能说是真的不好用，写一堆注解头痛)</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Api：用在请求的类上，表示对类的说明</span><br><span class=\"line\">    tags=&quot;说明该类的作用，可以在UI界面上看到的注解&quot;</span><br><span class=\"line\">    value=&quot;该参数没什么意义，在UI界面上也看到，所以不需要配置&quot;</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\">@ApiOperation：用在请求的方法上，说明方法的用途、作用</span><br><span class=\"line\">    value=&quot;说明方法的用途、作用&quot;</span><br><span class=\"line\">    notes=&quot;方法的备注说明&quot;</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\">@ApiImplicitParams：用在请求的方法上，表示一组参数说明</span><br><span class=\"line\">    @ApiImplicitParam：用在@ApiImplicitParams注解中，指定一个请求参数的各个方面</span><br><span class=\"line\">        name：参数名</span><br><span class=\"line\">        value：参数的汉字说明、解释</span><br><span class=\"line\">        required：参数是否必须传</span><br><span class=\"line\">        paramType：参数放在哪个地方</span><br><span class=\"line\">            · header --&gt; 请求参数的获取：@RequestHeader</span><br><span class=\"line\">            · query --&gt; 请求参数的获取：@RequestParam</span><br><span class=\"line\">            · path（用于restful接口）--&gt; 请求参数的获取：@PathVariable</span><br><span class=\"line\">            · body（不常用）</span><br><span class=\"line\">            · form（不常用）    </span><br><span class=\"line\">        dataType：参数类型，默认String，其它值dataType=&quot;Integer&quot;       </span><br><span class=\"line\">        defaultValue：参数的默认值</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\">@ApiResponses：用在请求的方法上，表示一组响应</span><br><span class=\"line\">    @ApiResponse：用在@ApiResponses中，一般用于表达一个错误的响应信息</span><br><span class=\"line\">        code：数字，例如400</span><br><span class=\"line\">        message：信息，例如&quot;请求参数没填好&quot;</span><br><span class=\"line\">        response：抛出异常的类</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\">@ApiModel：用于响应类上，表示一个返回响应数据的信息</span><br><span class=\"line\">            （这种一般用在post创建的时候，使用@RequestBody这样的场景，</span><br><span class=\"line\">            请求参数无法使用@ApiImplicitParam注解进行描述的时候）</span><br><span class=\"line\">    @ApiModelProperty：用在属性上，描述响应类的属性</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-api\"><a class=\"markdownIt-Anchor\" href=\"#1-api\">#</a> 1、@Api</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Api(tags=&quot;APP用户注册Controller&quot;)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>@Api：用在请求的类上，说明该类的作用<br>\n tags=“说明该类的作用”<br>\nvalue=“该参数没什么意义，所以不需要配置”</p>\n</blockquote>\n<h3 id=\"2-apioperation\"><a class=\"markdownIt-Anchor\" href=\"#2-apioperation\">#</a> 2、@ApiOperation</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@ApiOperation(value=&quot;用户登录&quot;,notes=&quot;填写账号密码都是必填&quot;)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>@ApiOperation：用在请求的方法上，说明方法的作用<br>\n @ApiOperation：“用在请求的方法上，说明方法的作用”<br>\nvalue=“说明方法的作用”<br>\nnotes=“方法的备注说明”</p>\n</blockquote>\n<h3 id=\"3-apiimplicitparams和apiimplicitparam这两个用的比较多\"><a class=\"markdownIt-Anchor\" href=\"#3-apiimplicitparams和apiimplicitparam这两个用的比较多\">#</a> <strong>3、@ApiImplicitParams 和 @ApiImplicitParam</strong> 这两个用的比较多</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@ApiImplicitParams(&#123;</span><br><span class=\"line\">    @ApiImplicitParam(name=&quot;mobile&quot;,value=&quot;手机号&quot;,required=true,paramType=&quot;form&quot;),</span><br><span class=\"line\">    @ApiImplicitParam(name=&quot;password&quot;,value=&quot;密码&quot;,required=true,paramType=&quot;form&quot;),</span><br><span class=\"line\">    @ApiImplicitParam(name=&quot;age&quot;,value=&quot;年龄&quot;,required=true,paramType=&quot;form&quot;,dataType=&quot;Integer&quot;)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">//@ApiImplicitParams：用在请求的方法上，包含一组参数说明</span><br><span class=\"line\">     //@ApiImplicitParams：用在请求的方法上，包含一组参数说明</span><br><span class=\"line\">     //@ApiImplicitParam：用在 @ApiImplicitParams 注解中，指定一个请求参数的配置信息       </span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>@ApiImplicitParams：用在请求的方法上，包含一组参数说明<br>\n @ApiImplicitParams：用在请求的方法上，包含一组参数说明<br>\n @ApiImplicitParam：用在 @ApiImplicitParams 注解中，指定一个请求参数的配置信息<br>\n name：参数名<br>\n value：参数的汉字说明、解释<br>\n required：参数是否必须传<br>\n paramType：参数放在哪个地方<br>\n・header --&gt; 请求参数的获取：@RequestHeader<br>\n・query --&gt; 请求参数的获取：@RequestParam<br>\n・path（用于 restful 接口）–&gt; 请求参数的获取：@PathVariable<br>\n・body（不常用）<br>\n・form（不常用）<br>\ndataType：参数类型，默认 String，其它值 dataType=“Integer”<br>\ndefaultValue：参数的默认值</p>\n</blockquote>\n<h3 id=\"4-apiresponses\"><a class=\"markdownIt-Anchor\" href=\"#4-apiresponses\">#</a> 4、@ApiResponses</h3>\n<p>@ApiOperation (value = “select1 请求”,notes = “多个参数，多种的查询参数类型”)</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@ApiResponses(&#123;</span><br><span class=\"line\">    @ApiResponse(code=400,message=&quot;请求参数没填好&quot;),</span><br><span class=\"line\">    @ApiResponse(code=404,message=&quot;请求路径没有或页面跳转路径不对&quot;)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>@ApiResponses：用于请求的方法上，表示一组响应<br>\n @ApiResponses：用于请求的方法上，表示一组响应<br>\n @ApiResponse：用在 @ApiResponses 中，一般用于表达一个错误的响应信息<br>\n code：数字，例如 400<br>\nmessage：信息，例如 &quot;请求参数没填好&quot;<br>\nresponse：抛出异常的类</p>\n</blockquote>\n<h3 id=\"5-apimodel\"><a class=\"markdownIt-Anchor\" href=\"#5-apimodel\">#</a> 5、@ApiModel</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@ApiModel(description= &quot;返回响应数据&quot;)</span><br><span class=\"line\">public class RestMessage implements Serializable&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">    @ApiModelProperty(value = &quot;是否成功&quot;)</span><br><span class=\"line\">    private boolean success=true;</span><br><span class=\"line\">    @ApiModelProperty(value = &quot;返回对象&quot;)</span><br><span class=\"line\">    private Object data;</span><br><span class=\"line\">    @ApiModelProperty(value = &quot;错误编号&quot;)</span><br><span class=\"line\">    private Integer errCode;</span><br><span class=\"line\">    @ApiModelProperty(value = &quot;错误信息&quot;)</span><br><span class=\"line\">    private String message;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>@ApiModel：用于响应类上，表示一个返回响应数据的信息<br>\n @ApiModel：用于响应类上，表示一个返回响应数据的信息<br>\n（这种一般用在 post 创建的时候，使用 @RequestBody 这样的场景，<br>\n请求参数无法使用 @ApiImplicitParam 注解进行描述的时候）<br>\n@ApiModelProperty：用在属性上，描述响应类的属性</p>\n</blockquote>\n",
            "tags": [
                "后端"
            ]
        },
        {
            "id": "http://miemiefeng.github.io/SpringBoot%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD/",
            "url": "http://miemiefeng.github.io/SpringBoot%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD/",
            "title": "SpringBoot实现文件上传和下载",
            "date_published": "2021-11-11T01:25:17.000Z",
            "content_html": "<p class=\"note note-danger\">本文仅展示了部分文件</p>\n<h4 id=\"一-搭建springboot开发环境\"><a class=\"markdownIt-Anchor\" href=\"#一-搭建springboot开发环境\">#</a> 一、搭建 SpringBoot 开发环境</h4>\n<h5 id=\"1创建项目略\"><a class=\"markdownIt-Anchor\" href=\"#1创建项目略\">#</a> 1. 创建项目（略）</h5>\n<h5 id=\"2配置applicationyml参数\"><a class=\"markdownIt-Anchor\" href=\"#2配置applicationyml参数\">#</a> 2. 配置 application.yml 参数</h5>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server:</span></span><br><span class=\"line\">  <span class=\"attr\">port:</span> <span class=\"number\">8036</span></span><br><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">datasource:</span></span><br><span class=\"line\">    <span class=\"attr\">username:</span> <span class=\"string\">****</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span>  <span class=\"string\">****</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span>  <span class=\"string\">****</span></span><br><span class=\"line\">    <span class=\"attr\">driver-class-name:</span> <span class=\"string\">com.mysql.cj.jdbc.Driver</span></span><br><span class=\"line\">    <span class=\"attr\">type:</span> <span class=\"string\">com.mysql.cj.jdbc.MysqlConnectionPoolDataSource</span></span><br><span class=\"line\">  <span class=\"attr\">application:</span></span><br><span class=\"line\">    <span class=\"attr\">name:</span> <span class=\"string\">hospital-file</span></span><br><span class=\"line\">  <span class=\"attr\">thymeleaf:</span></span><br><span class=\"line\">    <span class=\"attr\">cache:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">  <span class=\"attr\">servlet:</span></span><br><span class=\"line\">    <span class=\"attr\">multipart:</span></span><br><span class=\"line\">      <span class=\"attr\">enabled:</span> <span class=\"literal\">true</span> <span class=\"comment\">#开启 multipart 上传功能</span></span><br><span class=\"line\">      <span class=\"attr\">max-file-size:</span> <span class=\"string\">500MB</span></span><br><span class=\"line\">      <span class=\"attr\">file-size-threshold:</span> <span class=\"string\">2KB</span></span><br><span class=\"line\">      <span class=\"attr\">max-request-size:</span> <span class=\"string\">1024MB</span></span><br><span class=\"line\"><span class=\"attr\">mybatis-plus:</span> </span><br><span class=\"line\">  <span class=\"attr\">mapper-locations:</span> <span class=\"string\">classpath*:mybatis/*.xml</span></span><br><span class=\"line\"><span class=\"attr\">file:</span></span><br><span class=\"line\">  <span class=\"attr\">locations:</span> <span class=\"string\">D:/home/</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p class=\"note note-primary\">其中file.upload.path =D:/aplus参数为自定义的参数，有两种方式可以获取到此参数</p>\n<ul>\n<li>使用 @Value (&quot;${file.upload.path}&quot;)</li>\n<li>使配置参数可以自动绑定到 POJO 类。</li>\n</ul>\n<p class=\"note note-primary\">使配置参数绑定实体类详细代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 配置信息</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> fengbo</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@ConfigurationProperties(prefix = &quot;file&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FileProperty</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String filePath;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getFilePath</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> filePath;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setFilePath</span><span class=\"params\">(String filePath)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.filePath = filePath;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p class=\"note note-primary\">必须在@SpringbootUploadApplication注解的类中添加@EnableConfigurationProperties注解以开启ConfigurationProperties功能</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableConfigurationProperties(&#123;</span></span><br><span class=\"line\"><span class=\"meta\">        FileProperty.class</span></span><br><span class=\"line\"><span class=\"meta\">&#125;)</span></span><br><span class=\"line\"><span class=\"comment\">//@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)</span></span><br><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FileApplication</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(FileApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"3实体响应类和异常信息类\"><a class=\"markdownIt-Anchor\" href=\"#3实体响应类和异常信息类\">#</a> 3. 实体响应类和异常信息类</h5>\n<p class=\"note note-primary\">文件成功后需要有的响应实体类UploadFileResponse和文件出现上传异常类FileException来处理异常信息</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 文件管理表</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> fengbo</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@ApiModel(value=&quot;文件管理表&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@Builder</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(value = &quot;sys_file&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SysFileDto</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Serializable</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 主键id</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableId(value = &quot;id&quot;, type = IdType.INPUT)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;主键id&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String id;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 文件名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;file_name&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;文件名称&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String fileName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 文件类型</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;file_type&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;文件类型&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String fileType;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 文件大小</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;file_size&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;文件大小&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long fileSize;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 保存名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;save_name&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;保存名称&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String saveName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 保存路径</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;save_path&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;保存路径&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String savePath;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 下载路径</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;download_path&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;下载路径&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String downloadPath;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除标识</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;`valid`&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;删除标识&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer valid;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 创建时间</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;create_at&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;创建时间&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long createAt;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 修改时间</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;update_at&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;修改时间&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long updateAt;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 容器名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;bucket_name&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;容器名称&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String bucketName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 用户所属系统</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;solution_code&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;用户所属系统&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String solutionCode;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 用户id</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;user_id&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;用户id&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String userId;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 文件后缀</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;suffix&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value=&quot;文件后缀&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String suffix;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">SysFileDto</span><span class=\"params\">(String fileName, String downloadPath, String fileType,</span></span><br><span class=\"line\"><span class=\"params\">                      <span class=\"type\">long</span> fileSize, String suffix,String userId,String solutionCode,</span></span><br><span class=\"line\"><span class=\"params\">                      Long updateAt,Long createAt,Integer valid,String savePath,String saveName,String id)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.fileName = fileName;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.userId = userId;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.solutionCode = solutionCode;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.updateAt = updateAt;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.createAt = createAt;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.valid = valid;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.savePath = savePath;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.id = id;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.saveName = saveName;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.suffix = suffix;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.downloadPath = downloadPath;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.fileType = fileType;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.fileSize = fileSize;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">SysFileDto</span><span class=\"params\">(String fileName, String downloadPath, String fileType, <span class=\"type\">long</span> fileSize)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.fileName = fileName;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.downloadPath = downloadPath;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.fileType = fileType;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.fileSize = fileSize;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_ID</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;id&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_FILE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;file_name&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_FILE_TYPE</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;file_type&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_FILE_SIZE</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;file_size&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_SAVE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;save_name&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_SAVE_PATH</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;save_path&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_DOWNLOAD_PATH</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;download_path&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_VALID</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;valid&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_CREATE_AT</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;create_at&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_UPDATE_AT</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;update_at&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_BUCKET_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;bucket_name&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_SOLUTION_CODE</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;solution_code&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_USER_ID</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;user_id&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">COL_SUFFIX</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;suffix&quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p class=\"note note-primary\">异常信息处理类</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> fengbo</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Title</span>: FileException</span></span><br><span class=\"line\"><span class=\"comment\"> * 异常信息配置</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FileException</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">RuntimeException</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">FileException</span><span class=\"params\">(String message)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">FileException</span><span class=\"params\">(String message, Throwable cause)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(message, cause);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"4创建filecontroller\"><a class=\"markdownIt-Anchor\" href=\"#4创建filecontroller\">#</a> 4. 创建 FileController</h5>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 文件上传下载</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> fengbo</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Api(tags = &quot;文件管理&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FileController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> FileService fileService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 单文件上传</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> file</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;/uploadFile&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> SysFileDto <span class=\"title function_\">uploadFile</span><span class=\"params\">(<span class=\"meta\">@RequestParam(&quot;file&quot;)</span> MultipartFile file)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fileService.uploadFile(file);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 多文件上传</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> files</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;/uploadMultipleFiles&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;SysFileDto&gt; <span class=\"title function_\">uploadMultipleFiles</span><span class=\"params\">(<span class=\"meta\">@RequestParam(&quot;files&quot;)</span> MultipartFile[] files)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fileService.uploadMultiple(files);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 下载</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> fileName</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> request</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;/downloadFile/&#123;fileName:.*&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;Resource&gt; <span class=\"title function_\">downloadFile</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> String fileName, HttpServletRequest request)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fileService.download(fileName, request);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p class=\"note note-primary\">FileService实现类</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 文件管理</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> fengbo</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FileServiceImpl</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">ServiceImpl</span>&lt;FileMapper, SysFileDto&gt; <span class=\"keyword\">implements</span> <span class=\"title class_\">FileService</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Logger</span> <span class=\"variable\">logger</span> <span class=\"operator\">=</span> LoggerFactory.getLogger(FileServiceImpl.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Path fileStorageLocation; <span class=\"comment\">// 文件在本地存储的地址</span></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    FileMapper fileMapper;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">FileServiceImpl</span><span class=\"params\">( <span class=\"meta\">@Value(&quot;$&#123;file.locations&#125;&quot;)</span> String path)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.fileStorageLocation = Paths.get(path).toAbsolutePath().normalize();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Files.createDirectories(<span class=\"built_in\">this</span>.fileStorageLocation);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileException</span>(<span class=\"string\">&quot;Could not create the directory&quot;</span>, e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 存储文件到系统</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> file 文件</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 文件名</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">storeFile</span><span class=\"params\">(MultipartFile file)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Normalize file name</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> UUID.randomUUID().toString()+file.getOriginalFilename().substring(file.getOriginalFilename().lastIndexOf(<span class=\"string\">&quot;.&quot;</span>),file.getOriginalFilename().length());</span><br><span class=\"line\"><span class=\"comment\">//        String fileName = StringUtils.cleanPath(file.getOriginalFilename());</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Check if the file&#x27;s name contains invalid characters</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(fileName.contains(<span class=\"string\">&quot;..&quot;</span>)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileException</span>(<span class=\"string\">&quot;Sorry! Filename contains invalid path sequence &quot;</span> + fileName);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// Copy file to the target location (Replacing existing file with the same name)</span></span><br><span class=\"line\">            <span class=\"type\">Path</span> <span class=\"variable\">targetLocation</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.fileStorageLocation.resolve(fileName);</span><br><span class=\"line\">            Files.copy(file.getInputStream(), targetLocation, StandardCopyOption.REPLACE_EXISTING);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">return</span> fileName;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException ex) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileException</span>(<span class=\"string\">&quot;Could not store file &quot;</span> + fileName + <span class=\"string\">&quot;. Please try again!&quot;</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Resource <span class=\"title function_\">loadFileAsResource</span><span class=\"params\">(String fileName)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">Path</span> <span class=\"variable\">filePath</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.fileStorageLocation.resolve(fileName).normalize();</span><br><span class=\"line\">            <span class=\"type\">Resource</span> <span class=\"variable\">resource</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UrlResource</span>(filePath.toUri());</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(resource.exists()) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> resource;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileException</span>(<span class=\"string\">&quot;File not found &quot;</span> + fileName);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (MalformedURLException ex) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileException</span>(<span class=\"string\">&quot;File not found &quot;</span> + fileName, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 单文件上传</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> file</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> SysFileDto <span class=\"title function_\">uploadFile</span><span class=\"params\">(MultipartFile file)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.storeFile(file);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileDownloadUri</span> <span class=\"operator\">=</span> ServletUriComponentsBuilder.fromCurrentContextPath()</span><br><span class=\"line\">                .path(<span class=\"string\">&quot;/downloadFile/&quot;</span>)</span><br><span class=\"line\">                .path(fileName)</span><br><span class=\"line\">                .toUriString();</span><br><span class=\"line\">        <span class=\"comment\">//填充dto</span></span><br><span class=\"line\">        <span class=\"type\">SysFileDto</span> <span class=\"variable\">sysFileDto</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SysFileDto</span>();</span><br><span class=\"line\">        sysFileDto.setFileSize(file.getSize());</span><br><span class=\"line\">        sysFileDto.setFileName(fileName);</span><br><span class=\"line\">        sysFileDto.setFileType(file.getContentType());</span><br><span class=\"line\">        sysFileDto.setDownloadPath(fileDownloadUri);</span><br><span class=\"line\">        sysFileDto.setCreateAt(System.currentTimeMillis());</span><br><span class=\"line\">        sysFileDto.setUpdateAt(System.currentTimeMillis());</span><br><span class=\"line\">        sysFileDto.setId(UUID.randomUUID().toString());</span><br><span class=\"line\">        sysFileDto.setSaveName(file.getOriginalFilename().replace(<span class=\"string\">&quot; &quot;</span>,<span class=\"string\">&quot;&quot;</span>));</span><br><span class=\"line\">        sysFileDto.setUserId(<span class=\"string\">&quot;测试&quot;</span>);</span><br><span class=\"line\">        sysFileDto.setSavePath(fileStorageLocation.toFile().getPath());</span><br><span class=\"line\">        <span class=\"comment\">//默认生效0-生效1-失效</span></span><br><span class=\"line\">        sysFileDto.setValid(<span class=\"number\">0</span>);</span><br><span class=\"line\">        sysFileDto.setSuffix(file.getOriginalFilename().substring(file.getOriginalFilename().lastIndexOf(<span class=\"string\">&quot;.&quot;</span>),file.getOriginalFilename().length()));</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.save(sysFileDto);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sysFileDto;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 多文件上传</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> files</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;SysFileDto&gt; <span class=\"title function_\">uploadMultiple</span><span class=\"params\">(MultipartFile[] files)</span>&#123;</span><br><span class=\"line\">        List&lt;SysFileDto&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (files != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (MultipartFile multipartFile:files) &#123;</span><br><span class=\"line\">                <span class=\"type\">SysFileDto</span> <span class=\"variable\">uploadFileResponse</span> <span class=\"operator\">=</span> uploadFile(multipartFile);</span><br><span class=\"line\">                list.add(uploadFileResponse);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;Resource&gt; <span class=\"title function_\">download</span><span class=\"params\">(String fileName, HttpServletRequest request)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Resource</span> <span class=\"variable\">resource</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.loadFileAsResource(fileName);</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">contentType</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            request.getServletContext().getMimeType(resource.getFile().getAbsolutePath());</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            logger.info(<span class=\"string\">&quot;Could not determine file type.&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(contentType == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            contentType = <span class=\"string\">&quot;application/octet-stream&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        List&lt;String&gt; saveName  = fileMapper.findSaveNameByFileName(fileName);</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> saveName.get(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            name = URLEncoder.encode(name,<span class=\"string\">&quot;UTF-8&quot;</span>);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span>(UnsupportedEncodingException e)&#123;</span><br><span class=\"line\">            logger.info(<span class=\"string\">&quot;文件名转换异常&quot;</span>);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.ok()</span><br><span class=\"line\">                .contentType(MediaType.parseMediaType(contentType))</span><br><span class=\"line\">                .header(HttpHeaders.CONTENT_DISPOSITION, <span class=\"string\">&quot;attachment; filename=\\&quot;&quot;</span> +name+ <span class=\"string\">&quot;\\&quot;&quot;</span>)</span><br><span class=\"line\">                .body(resource);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>需要注意的是，文件名称中文乱码的问题。这里使用了 <code>URLEncoder.encode();</code></p>\n<p>文件名使用 uuid 生成储存。下载时替换为原文件名下载。</p>\n<p class=\"note note-primary\">mapper文件(只是为了查询文件名称)</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">mapper</span> <span class=\"keyword\">PUBLIC</span> <span class=\"string\">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class=\"string\">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">namespace</span>=<span class=\"string\">&quot;com.hostpital.file.mapper.FileMapper&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;BaseResultMap&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;com.hostpital.file.vo.SysFileVo&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;id&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;id&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;file_name&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;fileName&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;file_type&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;fileType&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;file_size&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;fileSize&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;save_name&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;saveName&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;save_path&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;savePath&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;download_path&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;downloadPath&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;valid&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;valid&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;create_at&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;createAt&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;update_at&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;updateAt&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;bucket_name&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;bucketName&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;solution_code&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;solutionCode&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;user_id&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;userId&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">&quot;suffix&quot;</span> <span class=\"attr\">property</span>=<span class=\"string\">&quot;suffix&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">sql</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;Base_Column_List&quot;</span>&gt;</span></span><br><span class=\"line\">        id,</span><br><span class=\"line\">        file_name,</span><br><span class=\"line\">        file_type,</span><br><span class=\"line\">        file_size,</span><br><span class=\"line\">        save_name,</span><br><span class=\"line\">        save_path,</span><br><span class=\"line\">        download_path,</span><br><span class=\"line\">        `valid`,</span><br><span class=\"line\">        create_at,</span><br><span class=\"line\">        update_at,</span><br><span class=\"line\">        bucket_name,</span><br><span class=\"line\">        solution_code,</span><br><span class=\"line\">        user_id,</span><br><span class=\"line\">        suffix</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">sql</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;findSaveNameByFileName&quot;</span> <span class=\"attr\">resultType</span>=<span class=\"string\">&quot;java.lang.String&quot;</span>&gt;</span></span><br><span class=\"line\">        select save_name</span><br><span class=\"line\">        from sys_file</span><br><span class=\"line\">        where file_name=#&#123;fileName&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mapper</span>&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h4 id=\"二-接口测试\"><a class=\"markdownIt-Anchor\" href=\"#二-接口测试\">#</a> 二、接口测试</h4>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116201344.png\" alt=\"20221116201344\"></p>\n",
            "tags": [
                "java",
                "springboot",
                "后端"
            ]
        }
    ]
}