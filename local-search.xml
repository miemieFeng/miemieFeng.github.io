<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>python打包exe,将冰墩墩送给你爱的人</title>
    <link href="/python%E6%89%93%E5%8C%85exe,%E5%B0%86%E5%86%B0%E5%A2%A9%E5%A2%A9%E9%80%81%E7%BB%99%E4%BD%A0%E7%88%B1%E7%9A%84%E4%BA%BA/"/>
    <url>/python%E6%89%93%E5%8C%85exe,%E5%B0%86%E5%86%B0%E5%A2%A9%E5%A2%A9%E9%80%81%E7%BB%99%E4%BD%A0%E7%88%B1%E7%9A%84%E4%BA%BA/</url>
    
    <content type="html"><![CDATA[<blockquote><p>最近大家都有冰墩墩，抢不到就去 github 拉一个</p></blockquote><h3 id="一-拉项目略"><a class="markdownIt-Anchor" href="#一-拉项目略">#</a> 一、拉项目（略）</h3><h3 id="二-pip安装pyinstaller"><a class="markdownIt-Anchor" href="#二-pip安装pyinstaller">#</a> 二、pip 安装 pyinstaller</h3><pre><code class="hljs">pip3 install pyinstaller</code></pre><h3 id="三-使用pyinstaller打包成exe发送给你爱的人"><a class="markdownIt-Anchor" href="#三-使用pyinstaller打包成exe发送给你爱的人">#</a> 三、使用 pyinstaller 打包成 exe 发送给你爱的人</h3><p>打包命令</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Pyinstaller -F setup<span class="hljs-selector-class">.py</span> 打包exe<br>Pyinstaller -F -w setup<span class="hljs-selector-class">.py</span> 不带控制台的打包<br>Pyinstaller -F -<span class="hljs-selector-tag">i</span> xx<span class="hljs-selector-class">.ico</span> setup<span class="hljs-selector-class">.py</span> 打包指定exe图标打包<br><br></code></pre></td></tr></table></figure><p><img src="http://47.108.248.23:8090/upload/2022/02/b7701875be59fa6a2651cbab82b319b-fcc39472663d4237b693d39ede0bad43.png" alt="b7701875be59fa6a2651cbab82b319b.png"></p><h3 id="成果"><a class="markdownIt-Anchor" href="#成果">#</a> 成果</h3><p><img src="http://47.108.248.23:8090/upload/2022/02/image-5773bb8dbb3b4e5084dcd4affcd21a36.png" alt="image.png"></p>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用黑群晖搭建旁路由</title>
    <link href="/%E4%BD%BF%E7%94%A8%E9%BB%91%E7%BE%A4%E6%99%96%E6%90%AD%E5%BB%BA%E6%97%81%E8%B7%AF%E7%94%B1/"/>
    <url>/%E4%BD%BF%E7%94%A8%E9%BB%91%E7%BE%A4%E6%99%96%E6%90%AD%E5%BB%BA%E6%97%81%E8%B7%AF%E7%94%B1/</url>
    
    <content type="html"><![CDATA[<blockquote><p>家里购置了 switch 自然是需要全家富强才可以更舒适的使用</p></blockquote><h3 id="一-安装虚拟机套件"><a class="markdownIt-Anchor" href="#一-安装虚拟机套件">#</a> 一、安装虚拟机套件</h3><p><strong>这里我选择安装旧版虚拟机套件，因为新版需要 vip 才可以开启 cpu 兼容</strong><br><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/image-602efa6a1b774c4397f317bbb091fcc0.png" alt="image-602efa6a1b774c4397f317bbb091fcc0"><br> 可以看到我这里安装了 2.31 版</p><h3 id="二-下载旁路由镜像"><a class="markdownIt-Anchor" href="#二-下载旁路由镜像">#</a> 二、下载旁路由镜像</h3><p><strong>这里我选择下载恩山大佬第一的镜像，下载地址 https://openwrt.mpdn.fun:8443</strong></p><h3 id="三-导入镜像"><a class="markdownIt-Anchor" href="#三-导入镜像">#</a> 三、导入镜像</h3><p>打开虚拟机软件，选择新增，导入 pc 镜像<img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116192456.png" alt="20221116192456"> 等待上传完毕即可</p><h3 id="四-启动镜像"><a class="markdownIt-Anchor" href="#四-启动镜像">#</a> 四、启动镜像</h3><p>首先选择虚拟机 - 导入<br><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116192548.png" alt="20221116192548"><br> 导入刚才上传的镜像<br> 1、然后启动并连接。在跳出来的窗口界面输入命令，vi etc/config/network ，修改一下软路由的 IP。<br>2、在 option ipaddr 后面把 IP 修改成为和主路由一个网段的，可以按 i 键进行修改，比如我设置成 192.1168。1.10，修改完后按 Esc 退出，接着输入命令 ：wq ，保存刚才的修改。<br>3、再输入 passwd 修改一下密码，修改的时候密码不会显示，不用担心，输完按回车就行，要连续输入两次。<br>4、最后输入命令 reboot 进行重启就 OK 了。<br>5、在浏览器输入刚才咱们修改过的 IP，这时候已经可以进入 Openwrt 的登陆界面了，填上自己设置的密码就可以进系统了</p><p><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116192621.png" alt="20221116192621"></p><h3 id="五-openwrt系统配置"><a class="markdownIt-Anchor" href="#五-openwrt系统配置">#</a> 五、Openwrt 系统配置</h3><p>系统装完了，要想正常使用还得配置一下，找到左侧菜单 网络 — 接口，选择 LAN 的接口进行修改。<br><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116192643.png" alt="20221116192643"><br> 网关和 dns 填自己的网关（忽略此接口处打上勾，不让旁路由提供 DHCP 服务，避免和主路由冲突。）<br><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116192705.png" alt="20221116192705"></p><h3 id="六-修改上网设备ip"><a class="markdownIt-Anchor" href="#六-修改上网设备ip">#</a> 六、修改上网设备 ip</h3><p>此时将上网设备的 ip 和 dns 改为我们旁路由的地址即可，我这里是改了小米路由器做二级路由</p><blockquote><p>此时连接了小米路由器的设备都可以通过旁路由来设置策略了</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>群晖</category>
      
    </categories>
    
    
    <tags>
      
      <tag>旁路由</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>swagger2 常用注解整理</title>
    <link href="/swagger2%20%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3%E6%95%B4%E7%90%86/"/>
    <url>/swagger2%20%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3%E6%95%B4%E7%90%86/</url>
    
    <content type="html"><![CDATA[<blockquote><p>最近用到 swagger 想着整理一下常用注解 (只能说是真的不好用，写一堆注解头痛)</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs language">@Api：用在请求的类上，表示对类的说明<br>    tags=&quot;说明该类的作用，可以在UI界面上看到的注解&quot;<br>    value=&quot;该参数没什么意义，在UI界面上也看到，所以不需要配置&quot;<br> <br> <br>@ApiOperation：用在请求的方法上，说明方法的用途、作用<br>    value=&quot;说明方法的用途、作用&quot;<br>    notes=&quot;方法的备注说明&quot;<br> <br> <br>@ApiImplicitParams：用在请求的方法上，表示一组参数说明<br>    @ApiImplicitParam：用在@ApiImplicitParams注解中，指定一个请求参数的各个方面<br>        name：参数名<br>        value：参数的汉字说明、解释<br>        required：参数是否必须传<br>        paramType：参数放在哪个地方<br>            · header --&gt; 请求参数的获取：@RequestHeader<br>            · query --&gt; 请求参数的获取：@RequestParam<br>            · path（用于restful接口）--&gt; 请求参数的获取：@PathVariable<br>            · body（不常用）<br>            · form（不常用）    <br>        dataType：参数类型，默认String，其它值dataType=&quot;Integer&quot;       <br>        defaultValue：参数的默认值<br> <br> <br>@ApiResponses：用在请求的方法上，表示一组响应<br>    @ApiResponse：用在@ApiResponses中，一般用于表达一个错误的响应信息<br>        code：数字，例如400<br>        message：信息，例如&quot;请求参数没填好&quot;<br>        response：抛出异常的类<br> <br> <br>@ApiModel：用于响应类上，表示一个返回响应数据的信息<br>            （这种一般用在post创建的时候，使用@RequestBody这样的场景，<br>            请求参数无法使用@ApiImplicitParam注解进行描述的时候）<br>    @ApiModelProperty：用在属性上，描述响应类的属性<br></code></pre></td></tr></table></figure><h3 id="1-api"><a class="markdownIt-Anchor" href="#1-api">#</a> 1、@Api</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs language">@Api(tags=&quot;APP用户注册Controller&quot;)<br></code></pre></td></tr></table></figure><blockquote><p>@Api：用在请求的类上，说明该类的作用<br> tags=“说明该类的作用”<br>value=“该参数没什么意义，所以不需要配置”</p></blockquote><h3 id="2-apioperation"><a class="markdownIt-Anchor" href="#2-apioperation">#</a> 2、@ApiOperation</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs language">@ApiOperation(value=&quot;用户登录&quot;,notes=&quot;填写账号密码都是必填&quot;)<br></code></pre></td></tr></table></figure><blockquote><p>@ApiOperation：用在请求的方法上，说明方法的作用<br> @ApiOperation：“用在请求的方法上，说明方法的作用”<br>value=“说明方法的作用”<br>notes=“方法的备注说明”</p></blockquote><h3 id="3-apiimplicitparams和apiimplicitparam这两个用的比较多"><a class="markdownIt-Anchor" href="#3-apiimplicitparams和apiimplicitparam这两个用的比较多">#</a> <strong>3、@ApiImplicitParams 和 @ApiImplicitParam</strong> 这两个用的比较多</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs language">@ApiImplicitParams(&#123;<br>    @ApiImplicitParam(name=&quot;mobile&quot;,value=&quot;手机号&quot;,required=true,paramType=&quot;form&quot;),<br>    @ApiImplicitParam(name=&quot;password&quot;,value=&quot;密码&quot;,required=true,paramType=&quot;form&quot;),<br>    @ApiImplicitParam(name=&quot;age&quot;,value=&quot;年龄&quot;,required=true,paramType=&quot;form&quot;,dataType=&quot;Integer&quot;)<br>&#125;)<br>//@ApiImplicitParams：用在请求的方法上，包含一组参数说明<br>     //@ApiImplicitParams：用在请求的方法上，包含一组参数说明<br>     //@ApiImplicitParam：用在 @ApiImplicitParams 注解中，指定一个请求参数的配置信息       <br></code></pre></td></tr></table></figure><blockquote><p>@ApiImplicitParams：用在请求的方法上，包含一组参数说明<br> @ApiImplicitParams：用在请求的方法上，包含一组参数说明<br> @ApiImplicitParam：用在 @ApiImplicitParams 注解中，指定一个请求参数的配置信息<br> name：参数名<br> value：参数的汉字说明、解释<br> required：参数是否必须传<br> paramType：参数放在哪个地方<br>・header --&gt; 请求参数的获取：@RequestHeader<br>・query --&gt; 请求参数的获取：@RequestParam<br>・path（用于 restful 接口）–&gt; 请求参数的获取：@PathVariable<br>・body（不常用）<br>・form（不常用）<br>dataType：参数类型，默认 String，其它值 dataType=“Integer”<br>defaultValue：参数的默认值</p></blockquote><h3 id="4-apiresponses"><a class="markdownIt-Anchor" href="#4-apiresponses">#</a> 4、@ApiResponses</h3><p>@ApiOperation (value = “select1 请求”,notes = “多个参数，多种的查询参数类型”)</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@ApiResponses</span>(&#123;<br>    <span class="hljs-variable">@ApiResponse</span>(code=<span class="hljs-number">400</span>,message=<span class="hljs-string">&quot;请求参数没填好&quot;</span>),<br>    <span class="hljs-variable">@ApiResponse</span>(code=<span class="hljs-number">404</span>,message=<span class="hljs-string">&quot;请求路径没有或页面跳转路径不对&quot;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><blockquote><p>@ApiResponses：用于请求的方法上，表示一组响应<br> @ApiResponses：用于请求的方法上，表示一组响应<br> @ApiResponse：用在 @ApiResponses 中，一般用于表达一个错误的响应信息<br> code：数字，例如 400<br>message：信息，例如 &quot;请求参数没填好&quot;<br>response：抛出异常的类</p></blockquote><h3 id="5-apimodel"><a class="markdownIt-Anchor" href="#5-apimodel">#</a> 5、@ApiModel</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs language">@ApiModel(description= &quot;返回响应数据&quot;)<br>public class RestMessage implements Serializable&#123;<br> <br>    @ApiModelProperty(value = &quot;是否成功&quot;)<br>    private boolean success=true;<br>    @ApiModelProperty(value = &quot;返回对象&quot;)<br>    private Object data;<br>    @ApiModelProperty(value = &quot;错误编号&quot;)<br>    private Integer errCode;<br>    @ApiModelProperty(value = &quot;错误信息&quot;)<br>    private String message;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>@ApiModel：用于响应类上，表示一个返回响应数据的信息<br> @ApiModel：用于响应类上，表示一个返回响应数据的信息<br>（这种一般用在 post 创建的时候，使用 @RequestBody 这样的场景，<br>请求参数无法使用 @ApiImplicitParam 注解进行描述的时候）<br>@ApiModelProperty：用在属性上，描述响应类的属性</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>swagger</category>
      
    </categories>
    
    
    <tags>
      
      <tag>后端</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>layui使用富文本编辑器并回显</title>
    <link href="/layui%E4%BD%BF%E7%94%A8%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8%E5%B9%B6%E5%9B%9E%E6%98%BE/"/>
    <url>/layui%E4%BD%BF%E7%94%A8%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8%E5%B9%B6%E5%9B%9E%E6%98%BE/</url>
    
    <content type="html"><![CDATA[<blockquote><p>正好要做一个文章管理，记录一下遇到的坑</p></blockquote><p>1. 引入富文本编辑器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs language">var layedit = layui.layedit;<br>layedit.set(&#123;<br>uploadImage: &#123;<br>url: &#x27;/v1/openApi/uploadImage&#x27; //接口url<br>,type: &#x27;&#x27; //默认post<br>&#125;<br>&#125;);<br>var index = layedit.build(&#x27;demo&#x27;);<br></code></pre></td></tr></table></figure><blockquote><p>这里我接入了图片上传</p></blockquote><p><strong>图片上传需要定义好接口</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs language">&#123;<br>  &quot;code&quot;: 0 //0表示成功，其它失败<br>  ,&quot;msg&quot;: &quot;&quot; //提示信息 //一般上传失败后返回<br>  ,&quot;data&quot;: &#123;<br>    &quot;src&quot;: &quot;图片路径&quot;<br>    ,&quot;title&quot;: &quot;图片名称&quot; //可选<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2. 富文本编辑器回显</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs language">&lt;textarea id=&quot;demo&quot; style=&quot;display: none;&quot; name=&quot;article&quot; autocomplete=&quot;off&quot; placeholder=&quot;内容&quot; th:text=&quot;*&#123;article&#125;&quot; &gt;&lt;/textarea&gt;<br></code></pre></td></tr></table></figure><p>这里我使用了 th:text</p><p>3. 最终效果<br><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116193413.png" alt="20221116193413"></p>]]></content>
    
    
    <categories>
      
      <category>layui</category>
      
    </categories>
    
    
    <tags>
      
      <tag>前端</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>解决fatal:unable to connect to gitee.com:gitee.com[0:180.97.125.228]:errno=Unknown error</title>
    <link href="/%20%E8%A7%A3%E5%86%B3%20fatal:%20unable%20to%20connect%20to%20gitee.com:%20gitee.com%5B0:%20180.97.125.228%5D:%20errno=Unknown%20error/"/>
    <url>/%20%E8%A7%A3%E5%86%B3%20fatal:%20unable%20to%20connect%20to%20gitee.com:%20gitee.com%5B0:%20180.97.125.228%5D:%20errno=Unknown%20error/</url>
    
    <content type="html"><![CDATA[<p>fatal: unable to connect to <a href="http://gitee.com">gitee.com</a>:<br><a href="http://gitee.com">gitee.com</a>[0: 180.97.125.228]: errno=Unknown error</p><p>直接找到.gitconfig 文件，把这几个配置删掉，就可以正常 push 了</p><p>[url “<a href="mailto:git@github.com">git@github.com</a>”]<br>insteadOf = <a href="https://github.com/:">https://github.com/:</a><br>[url “git://”]<br>insteadOf = https://<br>[url “https://”]<br>insteadOf = git://</p><blockquote><p>百度好久都找不到 焦躁哦</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>git</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>uni-app封装公共请求(携带token)</title>
    <link href="/uni-app%E5%B0%81%E8%A3%85%E5%85%AC%E5%85%B1%E8%AF%B7%E6%B1%82(%E6%90%BA%E5%B8%A6token)/"/>
    <url>/uni-app%E5%B0%81%E8%A3%85%E5%85%AC%E5%85%B1%E8%AF%B7%E6%B1%82(%E6%90%BA%E5%B8%A6token)/</url>
    
    <content type="html"><![CDATA[<blockquote><p>在日常开发过程中，一般请求我们都会携带 token, 以保证安全性</p></blockquote><h3 id="1-在工程目录下新建个common文件夹"><a class="markdownIt-Anchor" href="#1-在工程目录下新建个common文件夹">#</a> 1、在工程目录下新建个 common 文件夹</h3><p>在 common 目录下新增 request.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs language">//请求函数<br>const request = (url = &#x27;&#x27;, data = &#123;&#125;,type = &#x27;POST&#x27;, header = &#123;&#125;) =&gt; &#123;<br>// 缓存中获取token <br> header.token = data.token? data.token:uni.getStorageSync(&#x27;token&#x27;);<br> //请求地址<br> var baseUrl =  &#x27;http://localhost:9001/v1/openApi/&#x27;;  <br>    return new Promise((resolve, reject) =&gt; &#123;<br>        uni.request(&#123;<br>            method: type,<br>            url: baseUrl +url,<br>            data: data,<br>            header: header,<br>            dataType: &#x27;json&#x27;,        <br>        &#125;).then((response) =&gt; &#123;<br>            uni.hideLoading();<br>            uni.stopPullDownRefresh();<br>            let [error, res] = response;<br><br>console.log(res,&#x27;res&#x27;);<br>            if(res.data.code == 200)&#123;<br>                setTimeout(function () &#123;<br>                    resolve(res.data);<br>                &#125;, 1000);<br>            &#125;else if(res.data.code == 401)&#123;   //token失效时重新登录<br>                uni.showToast(&#123;<br>                    title:res.data.msg,<br>                    image:&#x27;../../static/public/close.png&#x27;,<br>                    duration: 2000,<br>                &#125;);<br>setTimeout(function()&#123;<br>uni.navigateTo(&#123;<br>    url: &#x27;/pages/login/login_vfcode&#x27;,<br>complete(e)&#123;<br>console.log(e,&#x27;eeeeeeeeee&#x27;)<br>&#125;<br>&#125;);<br>&#125;,1000);<br><br>            &#125; else if(res.data.code == -100)&#123;   //-100时返回处理<br>uni.showToast(&#123;<br>    title:res.data.msg,<br>    duration: 1000,<br>&#125;);<br>setTimeout(function () &#123;<br>//回调<br>    resolve(res.data);<br>&#125;, 1000);<br><br>            &#125;else &#123;  //其它code 返回提示<br>                uni.showToast(&#123;<br>                    title:res.data.msg,<br>                    image:&#x27;../../static/public/close.png&#x27;,<br>                    duration: 2000,<br>                &#125;);<br>            &#125;<br>        &#125;).catch(error =&gt; &#123;<br>            uni.hideLoading();<br>            uni.stopPullDownRefresh();<br>            let [err, res] = error;<br>            reject(err)<br>console.log(error ,&#x27;请求返回error&#x27;)<br>        &#125;)<br>    &#125;);<br>&#125;<br> <br>//定义对象<br>var api = &#123;<br>request<br>&#125;;<br> <br>export default api<br></code></pre></td></tr></table></figure><p>这里我是把 token 加到了请求头里</p><h3 id="2-在-mainjs-中引入-定义"><a class="markdownIt-Anchor" href="#2-在-mainjs-中引入-定义">#</a> 2、在 main.js 中引入、定义</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs language">import request from &#x27;common/request.js&#x27;  //引入封装全局<br> <br> <br> <br> <br>Vue.prototype.$api = request  <br></code></pre></td></tr></table></figure><h3 id="3-实际使用"><a class="markdownIt-Anchor" href="#3-实际使用">#</a> 3、实际使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs language">this.$api.request(&#x27;getBookingList&#x27;, <br>&#123;time: &#x27;2021-11-10&#x27;&#125;, <br>&#x27;post&#x27;).then((res) =&gt; &#123;<br>console.log(res, &#x27;res----&#x27;);<br>&#125;);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>uni-app</category>
      
    </categories>
    
    
    <tags>
      
      <tag>前端</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>解决 fatal:unable to connect to gitee.com:gitee.com[0:180.97.125.228]：errno=Unknown error</title>
    <link href="/%E8%A7%A3%E5%86%B3%E7%BE%A4%E8%BE%89%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%90%8Essh%E8%BF%9E%E6%8E%A5%E5%87%BA%E7%8E%B0connection%20is%20closed%20by%20foreign%20host/"/>
    <url>/%E8%A7%A3%E5%86%B3%E7%BE%A4%E8%BE%89%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%90%8Essh%E8%BF%9E%E6%8E%A5%E5%87%BA%E7%8E%B0connection%20is%20closed%20by%20foreign%20host/</url>
    
    <content type="html"><![CDATA[<h3 id="上次内网穿透后发现在家里一直无法通过穿透服务器连接群辉ssh"><a class="markdownIt-Anchor" href="#上次内网穿透后发现在家里一直无法通过穿透服务器连接群辉ssh">#</a> 上次内网穿透后，发现在家里一直无法通过穿透服务器连接群辉 ssh</h3><p><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116194141.png" alt="20221116194141"></p><h3 id="后来发现是被群辉拉入了黑名单解除就可以了"><a class="markdownIt-Anchor" href="#后来发现是被群辉拉入了黑名单解除就可以了">#</a> 后来发现是被群辉拉入了黑名单，解除就可以了</h3><p><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116194201.png" alt="20221116194201"></p><blockquote><p>取消自动封锁，或者把 ip 移出来</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>群晖</category>
      
    </categories>
    
    
    <tags>
      
      <tag>群晖</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>上传文件nginx报错(413 Request Entity Too Large)</title>
    <link href="/%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6nginx%E6%8A%A5%E9%94%99(413%20Request%20Entity%20Too%20Large)/"/>
    <url>/%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6nginx%E6%8A%A5%E9%94%99(413%20Request%20Entity%20Too%20Large)/</url>
    
    <content type="html"><![CDATA[<blockquote><p>部署舔狗日记的时候发现，字体文件太大无法上传.</p></blockquote><p>这可能是由于 Nginx 的上传大小限制所导致的。<br>可以在 Nginx 的配置文件下的 http 节点加入 client_max_body_size 1024m<br> 就解决了<br><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116194510.png" alt="20221116194510"></p>]]></content>
    
    
    <categories>
      
      <category>NGINX</category>
      
    </categories>
    
    
    <tags>
      
      <tag>服务器</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>黑群晖frp内网穿透</title>
    <link href="/%E9%BB%91%E7%BE%A4%E6%99%96frp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"/>
    <url>/%E9%BB%91%E7%BE%A4%E6%99%96frp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/</url>
    
    <content type="html"><![CDATA[<blockquote><p>前段时间闲来无事，吧家里的旧笔记本改造成了黑群晖.<br> 开通内网穿透踩了很多坑，特此记录一下</p></blockquote><p><strong>frp 分别有服务端 (frps) 和客户端 (frpc)</strong></p><h2 id="一-下面先说服务端"><a class="markdownIt-Anchor" href="#一-下面先说服务端">#</a> 一、下面先说服务端</h2><p>因为是第一次操作，所以没有使用 docker 管理。有时间一定要换成 docker</p><h4 id="1-首先下载frp根据自己的系统选择"><a class="markdownIt-Anchor" href="#1-首先下载frp根据自己的系统选择">#</a> 1、首先下载 frp（根据自己的系统选择）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs language">wget https://github.com/fatedier/frp/releases/download/v0.33.0/frp_0.33.0_linux_amd64.tar.gz<br></code></pre></td></tr></table></figure><h4 id="2-解压命令解压出来"><a class="markdownIt-Anchor" href="#2-解压命令解压出来">#</a> 2、解压命令解压出来</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs language">tar -zxvf frp_0.33.0_linux_amd64.tar.gz<br></code></pre></td></tr></table></figure><h4 id="3-进入-frp-目录"><a class="markdownIt-Anchor" href="#3-进入-frp-目录">#</a> 3、进入 frp 目录</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs language">cd frp_0.33.0_linux_amd64<br></code></pre></td></tr></table></figure><h4 id="4-配置服务器端文件"><a class="markdownIt-Anchor" href="#4-配置服务器端文件">#</a> 4、配置服务器端文件</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">vi</span> frps.ini<br><br></code></pre></td></tr></table></figure><blockquote><p>下面我把配置文件贴出来</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs language">[common]#必填<br>bind_port = 1231  #服务端口（可自定义）<br>vhost_http_port = 1232 #访问端口（可自定义）<br>dashboard_port = 7500 #dashboard 界面端口<br>dashboard_user = 账号#登录 dashboard 用户名<br>dashboard_pwd = 密码#登录 dashboard 密码<br>max_pool_count = 5#最大连接池数量<br>authentication_timeout = 900#超时验证时间<br>subdomain_host = 你的域名#自定义二级域名（这里我用了我另一个备案的域名）<br>[ssh]<br>listen_port = 6000 #访问端口<br>auth_token = 123321#用户身份认证<br></code></pre></td></tr></table></figure><h4 id="6-启动服务器端frps测试启动"><a class="markdownIt-Anchor" href="#6-启动服务器端frps测试启动">#</a> 6、启动服务器端 frps（测试启动）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs language">./frps -c ./frps.ini<br></code></pre></td></tr></table></figure><blockquote><p>如果没有报错，那么服务端的操作暂时完毕</p></blockquote><p>二、开始说客户端（群晖端）</p><blockquote><p>一开始群晖也是使用了和上边一样的操作，只是配置文件不同，后来发现一个弊端 ----&gt; 每次重启群晖后，frpc 不会自启动。或者因为不可抗力因素，frpc 关闭了很不方便</p></blockquote><h4 id="1-下载docker套件"><a class="markdownIt-Anchor" href="#1-下载docker套件">#</a> 1、下载 docker 套件</h4><p>首先我们打开套件中心，搜索 docker 并安装。docker 应该算是黑群晖必备套件我就不细说了</p><h4 id="2-下载frp"><a class="markdownIt-Anchor" href="#2-下载frp">#</a> 2、下载 frp</h4><p><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116194700.png" alt="20221116194700"></p><h3 id="2-启动容器"><a class="markdownIt-Anchor" href="#2-启动容器">#</a> 2、启动容器</h3><p>映射 frpc 文件，容器内路径为 <code>/frp/frpc.ini</code> ，容器外路径随意，自己选</p><h4 id="3-修改配置文件"><a class="markdownIt-Anchor" href="#3-修改配置文件">#</a> 3、修改配置文件</h4><p>一定要注意，我们的配置文件是 `frpc.ini，下面我把文件内容贴出来</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs language">[common]<br>server_addr = 服务端ip<br>server_port = 端口设置<br>auth_token = 随便设置<br>pool_count = 1<br>[ssh]<br>type = tcp<br>local_ip = 本地群晖ip<br>local_port = 22<br>remote_port = 6000<br>use_compression = true<br>use_encryption = true<br>[qh]#如果有多个端口一定不能和下面的名字重复了<br>type = http<br>local_port = 5000<br>subdomain = qh#这里一定是写你的二级域名前缀（坑点）<br>[ql]<br>type = http<br>local_port = 5700<br>subdomain = ql<br>[nl]<br>type = http<br>local_port = 5703<br>subdomain = nl<br>[sn]<br>type = http<br>local_port = 8181<br>subdomain = sn<br><br></code></pre></td></tr></table></figure><h4 id="4-启动服务器端"><a class="markdownIt-Anchor" href="#4-启动服务器端">#</a> 4、启动服务器端</h4><p>群晖启动服务端，进入高级设置，选择停止后重启，并且一定要选择使用和 dockerhost 相同网络</p><blockquote><p>此时如果容器没有无限容器那么说明已经是链接成功了，可以访问刚才自己配的地址去看，一定是域名加端口号访问。除非像我一样在服务端使用 nginx 分别反向代理</p></blockquote><h2 id="三-服务端frp后台运行"><a class="markdownIt-Anchor" href="#三-服务端frp后台运行">#</a> 三、服务端 frp 后台运行</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs language">nohup ./frps -c ./frps.ini &amp;<br></code></pre></td></tr></table></figure><p>最后贴上成果<br><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116194719.png" alt="20221116194719"></p>]]></content>
    
    
    <categories>
      
      <category>群晖</category>
      
    </categories>
    
    
    <tags>
      
      <tag>群晖</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>我的任务时间我做主(cron插件)</title>
    <link href="/%E6%88%91%E7%9A%84%E4%BB%BB%E5%8A%A1%E6%97%B6%E9%97%B4%E6%88%91%E5%81%9A%E4%B8%BB(cron%E6%8F%92%E4%BB%B6)/"/>
    <url>/%E6%88%91%E7%9A%84%E4%BB%BB%E5%8A%A1%E6%97%B6%E9%97%B4%E6%88%91%E5%81%9A%E4%B8%BB(cron%E6%8F%92%E4%BB%B6)/</url>
    
    <content type="html"><![CDATA[<h2 id="先说一下插件怎么使用"><a class="markdownIt-Anchor" href="#先说一下插件怎么使用">#</a> 先说一下插件怎么使用</h2><h3 id="1-点击浏览器右上角"><a class="markdownIt-Anchor" href="#1-点击浏览器右上角">#</a> 1、点击浏览器右上角</h3><p><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116194923.png" alt="20221116194923"></p><h3 id="2-打开开发者模式"><a class="markdownIt-Anchor" href="#2-打开开发者模式">#</a> 2、打开开发者模式</h3><p><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116194944.png" alt="20221116194944"></p><h3 id="3-拖入下载的压缩包即可使用啦"><a class="markdownIt-Anchor" href="#3-拖入下载的压缩包即可使用啦">#</a> 3、拖入下载的压缩包即可使用啦</h3><blockquote><p>github 地址：<a href="https://github.com/juillets/cron/releases">cron 插件</a></p></blockquote><h2 id="下面说下浏览器插件的核心文件manifestjson"><a class="markdownIt-Anchor" href="#下面说下浏览器插件的核心文件manifestjson">#</a> 下面说下浏览器插件的核心文件（manifest.json）</h2><blockquote><p>这个文件必须要有</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs language">&#123;<br>// 清单文件的版本，这个必须写，而且必须是2<br>&quot;manifest_version&quot;: 2,<br>// 插件的名称<br>&quot;name&quot;: &quot;Cron表达式生成&quot;,<br>// 插件的版本<br>&quot;version&quot;: &quot;1.0.0&quot;,<br>// 插件描述<br>&quot;description&quot;: &quot;Cron表达式生成&quot;,<br>// 图标，这里我偷懒全部用一个尺寸<br>&quot;icons&quot;: &#123;<br>&quot;16&quot;: &quot;img/icon.png&quot;,<br>&quot;48&quot;: &quot;img/icon.png&quot;,<br>&quot;128&quot;: &quot;img/icon.png&quot;<br>&#125;,<br>    <br>// 浏览器右上角图标设置，browser_action、page_action、app必须三选一<br>&quot;browser_action&quot;: &#123;<br>&quot;default_icon&quot;: &quot;img/icon.png&quot;,<br>&quot;default_title&quot;: &quot;Cron表达式生成&quot;,<br>&quot;default_popup&quot;: &quot;demo.html&quot;<br>&#125;,<br>&quot;options_ui&quot;: &#123;<br>&quot;page&quot;: &quot;demo.html&quot;,<br>// 添加一些默认的样式，推荐使用<br>&quot;chrome_style&quot;: true<br>&#125;,<br>//权限申请<br>&quot;permissions&quot;: [<br><br>],<br>//插件主页<br>&quot;homepage_url&quot;: &quot;http://47.108.248.23:8090/&quot;,<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>cron插件</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cron插件</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nginx的安装与配置</title>
    <link href="/nginx%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/"/>
    <url>/nginx%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h4 id="一-nginx的安装"><a class="markdownIt-Anchor" href="#一-nginx的安装">#</a> 一、nginx 的安装</h4><p>最近正好申请了 ssl 证书寻思重新配置一下 nginx，做个记录。</p><h5 id="1-安装"><a class="markdownIt-Anchor" href="#1-安装">#</a> 1、安装</h5><p>这里我选择下载安装包，所以先创建 nginx 的默认目录。</p><p>一般是放在 <code>/usr/local</code>  下</p><blockquote><p>以下操作在 <code>/user/local</code>  进行<br>本次下载非最新版，可自行更改版本号</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">wget -c https://nginx.org/download/nginx-1.10.1.tar.gz<br></code></pre></td></tr></table></figure><h5 id="2-解压安装包"><a class="markdownIt-Anchor" href="#2-解压安装包">#</a> 2、解压安装包</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">tar -zxvf nginx-1.10.1.tar.gz<br></code></pre></td></tr></table></figure><h5 id="3-安装"><a class="markdownIt-Anchor" href="#3-安装">#</a> 3、安装</h5><p>进入解压后的文件夹</p><blockquote><p>这里我们使用默认配置</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">./configure<br></code></pre></td></tr></table></figure><h5 id="4-编译安装"><a class="markdownIt-Anchor" href="#4-编译安装">#</a> 4、编译安装</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">make<br>make install<br></code></pre></td></tr></table></figure><h5 id="5-启动nginx"><a class="markdownIt-Anchor" href="#5-启动nginx">#</a> 5、启动 nginx</h5><p>此时返回上一级目录便可看到 nginx 文件夹<br>进入 /usr/local/nginx/sbin<br><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116195150.png" alt="20221116195150"><br> 输入 <code>./nginx</code>  即可启动 nginx</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">./nginx <span class="hljs-comment">#启动nginx</span><br>./nginx -s quit <span class="hljs-comment">#关闭nginx</span><br>./nginx -s reload <span class="hljs-comment">#重启nginx</span><br></code></pre></td></tr></table></figure><h4 id="二-配置nginx"><a class="markdownIt-Anchor" href="#二-配置nginx">#</a> 二、配置 nginx</h4><p>进入 /usr/local/nginx/conf</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">vim nginx.conf<br></code></pre></td></tr></table></figure><p>修改自己所需要的配置即可</p>]]></content>
    
    
    <categories>
      
      <category>nginx</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>layui引入百度地图，点击获取当前位置</title>
    <link href="/layui%E5%BC%95%E5%85%A5%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE%EF%BC%8C%E7%82%B9%E5%87%BB%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE/"/>
    <url>/layui%E5%BC%95%E5%85%A5%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE%EF%BC%8C%E7%82%B9%E5%87%BB%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h5 id="一-申请百度地图的ak略"><a class="markdownIt-Anchor" href="#一-申请百度地图的ak略">#</a> 一、申请百度地图的 ak（略）</h5><h5 id="二-引入百度地图"><a class="markdownIt-Anchor" href="#二-引入百度地图">#</a> 二、引入百度地图</h5><p class="note note-primary">先插入代码，分块讲解</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">th:block</span> <span class="hljs-attr">th:include</span>=<span class="hljs-string">&quot;include :: header(&#x27;服务网点管理修改&#x27;)&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://api.map.baidu.com/api?v=2.0&amp;ak=自己申请&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--百度地图key要自己注册,或者用1.4以下的版本(不需要key)--&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">th:object</span>=<span class="hljs-string">&quot;$&#123;ServiceNetwork&#125;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;mainBox&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main-container&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main-container&quot;</span>&gt;</span><br><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display:none;&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>id<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;*&#123;id&#125;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">&quot;off&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;电站编号&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>服务网点名称<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;*&#123;serviceName&#125;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;serviceName&quot;</span> <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">&quot;off&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;服务网点名称&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>服务网点地址<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width:697px;height:550px;border:#ccc solid 1px;&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dituContent&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;*&#123;serviceAddress&#125;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;serviceAddress&quot;</span> <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">&quot;off&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;服务网点地址&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>营业时间<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;*&#123;businessHours&#125;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;businessHours&quot;</span> <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">&quot;off&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;营业时间&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>营运状态 <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">th:field</span>=<span class="hljs-string">&quot;*&#123;operatingStatus&#125;&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;operatingStatus&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;operatingStatus&quot;</span></span><br><span class="hljs-tag">                                <span class="hljs-attr">th:with</span>=<span class="hljs-string">&quot;type=$&#123;@dict.getType(&#x27;operating_status&#x27;)&#125;&quot;</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">th:each</span>=<span class="hljs-string">&quot;dict : $&#123;type&#125;&quot;</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;dict.dictLabel&#125;&quot;</span></span><br><span class="hljs-tag">                                    <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;$&#123;dict.dictValue&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>服务网点状态<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">th:field</span>=<span class="hljs-string">&quot;*&#123;serviceStatus&#125;&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;serviceStatus&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;serviceStatus&quot;</span></span><br><span class="hljs-tag">                                <span class="hljs-attr">th:with</span>=<span class="hljs-string">&quot;type=$&#123;@dict.getType(&#x27;serviceStatus&#x27;)&#125;&quot;</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">th:each</span>=<span class="hljs-string">&quot;dict : $&#123;type&#125;&quot;</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;dict.dictLabel&#125;&quot;</span></span><br><span class="hljs-tag">                                    <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;$&#123;dict.dictValue&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>电柜容量<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;*&#123;electricCabinetCapacity&#125;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;electricCabinetCapacity&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">&quot;off&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;电柜容量&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>电柜数量<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;*&#123;numberElectricCabinets&#125;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;numberElectricCabinets&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">&quot;off&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;电柜数量&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>电池数据<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;*&#123;batteryData&#125;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;batteryData&quot;</span> <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">&quot;off&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;电池数据&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;bottom&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;button-container&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn layui-btn-normal layui-btn-sm&quot;</span> <span class="hljs-attr">lay-submit</span>=<span class="hljs-string">&quot;&quot;</span></span><br><span class="hljs-tag">                    <span class="hljs-attr">lay-filter</span>=<span class="hljs-string">&quot;serviceNetwork-update&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-ok&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                提交<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;reset&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-btn layui-btn-primary layui-btn-sm&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-icon layui-icon-refresh&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>                重置<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">th:block</span> <span class="hljs-attr">th:include</span>=<span class="hljs-string">&quot;include :: footer&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">//创建和初始化地图函数：</span></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">initMap</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">createMap</span>();<span class="hljs-comment">//创建地图</span></span><br><span class="language-javascript">        <span class="hljs-title function_">setMapEvent</span>();<span class="hljs-comment">//设置地图事件</span></span><br><span class="language-javascript">        <span class="hljs-title function_">addMapControl</span>();<span class="hljs-comment">//向地图添加控件</span></span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">//创建地图函数：</span></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">createMap</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">Map</span>(<span class="hljs-string">&quot;dituContent&quot;</span>);<span class="hljs-comment">//在百度地图容器中创建一个地图</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> point = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">Point</span>(<span class="hljs-number">106.61680</span>, <span class="hljs-number">29.57793</span>);<span class="hljs-comment">//定义一个中心点坐标(当前坐标重庆)</span></span><br><span class="language-javascript">        map.<span class="hljs-title function_">centerAndZoom</span>(point, <span class="hljs-number">12</span>);<span class="hljs-comment">//设定地图的中心点和坐标并将地图显示在地图容器中</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">window</span>.<span class="hljs-property">map</span> = map;<span class="hljs-comment">//将map变量存储在全局</span></span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">//地图事件设置函数：</span></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">setMapEvent</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        map.<span class="hljs-title function_">enableDragging</span>();<span class="hljs-comment">//启用地图拖拽事件，默认启用(可不写)</span></span><br><span class="language-javascript">        map.<span class="hljs-title function_">enableScrollWheelZoom</span>();<span class="hljs-comment">//启用地图滚轮放大缩小</span></span><br><span class="language-javascript">        map.<span class="hljs-title function_">enableDoubleClickZoom</span>();<span class="hljs-comment">//启用鼠标双击放大，默认启用(可不写)</span></span><br><span class="language-javascript">        map.<span class="hljs-title function_">enableKeyboard</span>();<span class="hljs-comment">//启用键盘上下左右键移动地图</span></span><br><span class="language-javascript">        map.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e)</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> point = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">Point</span>(e.<span class="hljs-property">Ag</span>.<span class="hljs-property">lng</span>, e.<span class="hljs-property">Ag</span>.<span class="hljs-property">lat</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> gc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">Geocoder</span>();</span><br><span class="language-javascript">            gc.<span class="hljs-title function_">getLocation</span>(point, <span class="hljs-keyword">function</span> (<span class="hljs-params">rs</span>) &#123;</span><br><span class="language-javascript">                $(<span class="hljs-string">&quot;input[name=&#x27;serviceAddress&#x27;]&quot;</span>).<span class="hljs-title function_">val</span>(rs.<span class="hljs-property">address</span>);</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rs.<span class="hljs-property">address</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> opts = &#123;</span><br><span class="language-javascript">                    <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;行政区划归属&#x27;</span>,</span><br><span class="language-javascript">                    <span class="hljs-attr">width</span>: <span class="hljs-number">220</span>,</span><br><span class="language-javascript">                    <span class="hljs-attr">height</span>: <span class="hljs-number">92</span></span><br><span class="language-javascript">                &#125;;</span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> infoStr = <span class="hljs-string">&#x27;&lt;div&gt;省：&#x27;</span> + rs.<span class="hljs-property">addressComponents</span>.<span class="hljs-property">province</span> + <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span></span><br><span class="language-javascript">                    + <span class="hljs-string">&#x27;&lt;div&gt;市：&#x27;</span> + rs.<span class="hljs-property">addressComponents</span>.<span class="hljs-property">city</span> + <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span></span><br><span class="language-javascript">                    + <span class="hljs-string">&#x27;&lt;div&gt;区：&#x27;</span> + rs.<span class="hljs-property">addressComponents</span>.<span class="hljs-property">district</span> + <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> infoWindow = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">InfoWindow</span>(infoStr, opts);</span><br><span class="language-javascript">                map.<span class="hljs-title function_">openInfoWindow</span>(infoWindow, point);</span><br><span class="language-javascript"></span><br><span class="language-javascript">            &#125;);</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">//地图控件添加函数：</span></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">addMapControl</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">//向地图中添加缩放控件</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ctrl_nav = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">NavigationControl</span>(&#123;<span class="hljs-attr">anchor</span>: <span class="hljs-variable constant_">BMAP_ANCHOR_TOP_LEFT</span>, <span class="hljs-attr">type</span>: <span class="hljs-variable constant_">BMAP_NAVIGATION_CONTROL_LARGE</span>&#125;);</span><br><span class="language-javascript">        map.<span class="hljs-title function_">addControl</span>(ctrl_nav);</span><br><span class="language-javascript">        <span class="hljs-comment">//向地图中添加缩略图控件</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ctrl_ove = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">OverviewMapControl</span>(&#123;<span class="hljs-attr">anchor</span>: <span class="hljs-variable constant_">BMAP_ANCHOR_BOTTOM_RIGHT</span>, <span class="hljs-attr">isOpen</span>: <span class="hljs-number">1</span>&#125;);</span><br><span class="language-javascript">        map.<span class="hljs-title function_">addControl</span>(ctrl_ove);</span><br><span class="language-javascript">        <span class="hljs-comment">//向地图中添加比例尺控件</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ctrl_sca = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">ScaleControl</span>(&#123;<span class="hljs-attr">anchor</span>: <span class="hljs-variable constant_">BMAP_ANCHOR_BOTTOM_LEFT</span>&#125;);</span><br><span class="language-javascript">        map.<span class="hljs-title function_">addControl</span>(ctrl_sca);</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-title function_">initMap</span>();<span class="hljs-comment">//创建和初始化地图</span></span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    layui.<span class="hljs-title function_">use</span>([<span class="hljs-string">&#x27;form&#x27;</span>, <span class="hljs-string">&#x27;laydate&#x27;</span>, <span class="hljs-string">&#x27;jquery&#x27;</span>], <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> form = layui.<span class="hljs-property">form</span>;</span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> $ = layui.<span class="hljs-property">jquery</span>;</span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> <span class="hljs-variable constant_">MODULE_PATH</span> = rootPath + <span class="hljs-string">&quot;/ServiceNetworkController&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">        form.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;submit(serviceNetwork-update)&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> loader = layer.<span class="hljs-title function_">load</span>();</span><br><span class="language-javascript">            $.<span class="hljs-title function_">ajax</span>(&#123;</span><br><span class="language-javascript">                <span class="hljs-attr">url</span>: <span class="hljs-variable constant_">MODULE_PATH</span> + <span class="hljs-string">&#x27;/edit&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">data</span>: data.<span class="hljs-property">field</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">dataType</span>: <span class="hljs-string">&#x27;json&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">contentType</span>: <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;post&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">result</span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (result.<span class="hljs-property">code</span> == <span class="hljs-number">200</span>) &#123;</span><br><span class="language-javascript">                        layer.<span class="hljs-title function_">msg</span>(result.<span class="hljs-property">msg</span>, &#123;<span class="hljs-attr">icon</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">time</span>: <span class="hljs-number">1000</span>&#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                            parent.<span class="hljs-property">layer</span>.<span class="hljs-title function_">close</span>(parent.<span class="hljs-property">layer</span>.<span class="hljs-title function_">getFrameIndex</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span>));<span class="hljs-comment">//关闭当前页</span></span><br><span class="language-javascript">                            parent.<span class="hljs-property">layui</span>.<span class="hljs-property">table</span>.<span class="hljs-title function_">reload</span>(<span class="hljs-string">&quot;serviceNetwork-table&quot;</span>);</span><br><span class="language-javascript">                            layer.<span class="hljs-title function_">close</span>(loader);</span><br><span class="language-javascript">                        &#125;);</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        layer.<span class="hljs-title function_">msg</span>(result.<span class="hljs-property">msg</span>, &#123;<span class="hljs-attr">icon</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">time</span>: <span class="hljs-number">1000</span>&#125;);</span><br><span class="language-javascript">                        layer.<span class="hljs-title function_">close</span>(loader);</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h6 id="1引入地图ak需要自己申请"><a class="markdownIt-Anchor" href="#1引入地图ak需要自己申请">#</a> 1. 引入地图 (ak 需要自己申请)</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://api.map.baidu.com/api?v=2.0&amp;ak=ak需要自己申请&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h6 id="2将地图div放置在合适的地方"><a class="markdownIt-Anchor" href="#2将地图div放置在合适的地方">#</a> 2. 将地图 div 放置在合适的地方</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-item&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-form-label&quot;</span>&gt;</span>服务网点地址<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input-block&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width:697px;height:550px;border:#ccc solid 1px;&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dituContent&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;*&#123;serviceAddress&#125;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;serviceAddress&quot;</span> <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">&quot;off&quot;</span></span><br><span class="hljs-tag">               <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;服务网点地址&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-input&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3. 设置地图相关函数</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">//创建和初始化地图函数：</span></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">initMap</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">createMap</span>();<span class="hljs-comment">//创建地图</span></span><br><span class="language-javascript">        <span class="hljs-title function_">setMapEvent</span>();<span class="hljs-comment">//设置地图事件</span></span><br><span class="language-javascript">        <span class="hljs-title function_">addMapControl</span>();<span class="hljs-comment">//向地图添加控件</span></span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">//创建地图函数：</span></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">createMap</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">Map</span>(<span class="hljs-string">&quot;dituContent&quot;</span>);<span class="hljs-comment">//在百度地图容器中创建一个地图</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> point = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">Point</span>(<span class="hljs-number">106.61680</span>, <span class="hljs-number">29.57793</span>);<span class="hljs-comment">//定义一个中心点坐标(当前坐标重庆)</span></span><br><span class="language-javascript">        map.<span class="hljs-title function_">centerAndZoom</span>(point, <span class="hljs-number">12</span>);<span class="hljs-comment">//设定地图的中心点和坐标并将地图显示在地图容器中</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">window</span>.<span class="hljs-property">map</span> = map;<span class="hljs-comment">//将map变量存储在全局</span></span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">//地图事件设置函数：</span></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">setMapEvent</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        map.<span class="hljs-title function_">enableDragging</span>();<span class="hljs-comment">//启用地图拖拽事件，默认启用(可不写)</span></span><br><span class="language-javascript">        map.<span class="hljs-title function_">enableScrollWheelZoom</span>();<span class="hljs-comment">//启用地图滚轮放大缩小</span></span><br><span class="language-javascript">        map.<span class="hljs-title function_">enableDoubleClickZoom</span>();<span class="hljs-comment">//启用鼠标双击放大，默认启用(可不写)</span></span><br><span class="language-javascript">        map.<span class="hljs-title function_">enableKeyboard</span>();<span class="hljs-comment">//启用键盘上下左右键移动地图</span></span><br><span class="language-javascript">        map.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e)</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> point = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">Point</span>(e.<span class="hljs-property">Ag</span>.<span class="hljs-property">lng</span>, e.<span class="hljs-property">Ag</span>.<span class="hljs-property">lat</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> gc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">Geocoder</span>();</span><br><span class="language-javascript">            gc.<span class="hljs-title function_">getLocation</span>(point, <span class="hljs-keyword">function</span> (<span class="hljs-params">rs</span>) &#123;</span><br><span class="language-javascript">                $(<span class="hljs-string">&quot;input[name=&#x27;serviceAddress&#x27;]&quot;</span>).<span class="hljs-title function_">val</span>(rs.<span class="hljs-property">address</span>);</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rs.<span class="hljs-property">address</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> opts = &#123;</span><br><span class="language-javascript">                    <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;行政区划归属&#x27;</span>,</span><br><span class="language-javascript">                    <span class="hljs-attr">width</span>: <span class="hljs-number">220</span>,</span><br><span class="language-javascript">                    <span class="hljs-attr">height</span>: <span class="hljs-number">92</span></span><br><span class="language-javascript">                &#125;;</span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> infoStr = <span class="hljs-string">&#x27;&lt;div&gt;省：&#x27;</span> + rs.<span class="hljs-property">addressComponents</span>.<span class="hljs-property">province</span> + <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span></span><br><span class="language-javascript">                    + <span class="hljs-string">&#x27;&lt;div&gt;市：&#x27;</span> + rs.<span class="hljs-property">addressComponents</span>.<span class="hljs-property">city</span> + <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span></span><br><span class="language-javascript">                    + <span class="hljs-string">&#x27;&lt;div&gt;区：&#x27;</span> + rs.<span class="hljs-property">addressComponents</span>.<span class="hljs-property">district</span> + <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> infoWindow = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">InfoWindow</span>(infoStr, opts);</span><br><span class="language-javascript">                map.<span class="hljs-title function_">openInfoWindow</span>(infoWindow, point);</span><br><span class="language-javascript"></span><br><span class="language-javascript">            &#125;);</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">//地图控件添加函数：</span></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">addMapControl</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">//向地图中添加缩放控件</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ctrl_nav = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">NavigationControl</span>(&#123;<span class="hljs-attr">anchor</span>: <span class="hljs-variable constant_">BMAP_ANCHOR_TOP_LEFT</span>, <span class="hljs-attr">type</span>: <span class="hljs-variable constant_">BMAP_NAVIGATION_CONTROL_LARGE</span>&#125;);</span><br><span class="language-javascript">        map.<span class="hljs-title function_">addControl</span>(ctrl_nav);</span><br><span class="language-javascript">        <span class="hljs-comment">//向地图中添加缩略图控件</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ctrl_ove = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">OverviewMapControl</span>(&#123;<span class="hljs-attr">anchor</span>: <span class="hljs-variable constant_">BMAP_ANCHOR_BOTTOM_RIGHT</span>, <span class="hljs-attr">isOpen</span>: <span class="hljs-number">1</span>&#125;);</span><br><span class="language-javascript">        map.<span class="hljs-title function_">addControl</span>(ctrl_ove);</span><br><span class="language-javascript">        <span class="hljs-comment">//向地图中添加比例尺控件</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ctrl_sca = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">ScaleControl</span>(&#123;<span class="hljs-attr">anchor</span>: <span class="hljs-variable constant_">BMAP_ANCHOR_BOTTOM_LEFT</span>&#125;);</span><br><span class="language-javascript">        map.<span class="hljs-title function_">addControl</span>(ctrl_sca);</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-title function_">initMap</span>();<span class="hljs-comment">//创建和初始化地图</span></span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="三-地图函数"><a class="markdownIt-Anchor" href="#三-地图函数">#</a> 三、地图函数</h5><p class="note note-primary">以下为点击并获取当前地址名称</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//地图事件设置函数：</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">setMapEvent</span>(<span class="hljs-params"></span>) &#123;<br>    map.<span class="hljs-title function_">enableDragging</span>();<span class="hljs-comment">//启用地图拖拽事件，默认启用(可不写)</span><br>    map.<span class="hljs-title function_">enableScrollWheelZoom</span>();<span class="hljs-comment">//启用地图滚轮放大缩小</span><br>    map.<span class="hljs-title function_">enableDoubleClickZoom</span>();<span class="hljs-comment">//启用鼠标双击放大，默认启用(可不写)</span><br>    map.<span class="hljs-title function_">enableKeyboard</span>();<span class="hljs-comment">//启用键盘上下左右键移动地图</span><br>    map.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e)<br>        <span class="hljs-keyword">var</span> point = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">Point</span>(e.<span class="hljs-property">Ag</span>.<span class="hljs-property">lng</span>, e.<span class="hljs-property">Ag</span>.<span class="hljs-property">lat</span>);<br>        <span class="hljs-keyword">var</span> gc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">Geocoder</span>();<br>        gc.<span class="hljs-title function_">getLocation</span>(point, <span class="hljs-keyword">function</span> (<span class="hljs-params">rs</span>) &#123;<br>            $(<span class="hljs-string">&quot;input[name=&#x27;serviceAddress&#x27;]&quot;</span>).<span class="hljs-title function_">val</span>(rs.<span class="hljs-property">address</span>);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rs.<span class="hljs-property">address</span>)<br>            <span class="hljs-keyword">var</span> opts = &#123;<br>                <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;行政区划归属&#x27;</span>,<br>                <span class="hljs-attr">width</span>: <span class="hljs-number">220</span>,<br>                <span class="hljs-attr">height</span>: <span class="hljs-number">92</span><br>            &#125;;<br>            <span class="hljs-keyword">var</span> infoStr = <span class="hljs-string">&#x27;&lt;div&gt;省：&#x27;</span> + rs.<span class="hljs-property">addressComponents</span>.<span class="hljs-property">province</span> + <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span><br>                + <span class="hljs-string">&#x27;&lt;div&gt;市：&#x27;</span> + rs.<span class="hljs-property">addressComponents</span>.<span class="hljs-property">city</span> + <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span><br>                + <span class="hljs-string">&#x27;&lt;div&gt;区：&#x27;</span> + rs.<span class="hljs-property">addressComponents</span>.<span class="hljs-property">district</span> + <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span>;<br>            <span class="hljs-keyword">var</span> infoWindow = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BMap</span>.<span class="hljs-title class_">InfoWindow</span>(infoStr, opts);<br>            map.<span class="hljs-title function_">openInfoWindow</span>(infoWindow, point);<br><br>        &#125;);<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><p>其中 <code>$(&quot;input[name='serviceAddress']&quot;).val(rs.address);</code>  赋值给 input 框</p><p>三、成果<br><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116201128.png" alt="20221116201128"></p>]]></content>
    
    
    <categories>
      
      <category>layui</category>
      
    </categories>
    
    
    <tags>
      
      <tag>前端</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBoot实现文件上传和下载</title>
    <link href="/SpringBoot%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD/"/>
    <url>/SpringBoot%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD/</url>
    
    <content type="html"><![CDATA[<p class="note note-danger">本文仅展示了部分文件</p><h4 id="一-搭建springboot开发环境"><a class="markdownIt-Anchor" href="#一-搭建springboot开发环境">#</a> 一、搭建 SpringBoot 开发环境</h4><h5 id="1创建项目略"><a class="markdownIt-Anchor" href="#1创建项目略">#</a> 1. 创建项目（略）</h5><h5 id="2配置applicationyml参数"><a class="markdownIt-Anchor" href="#2配置applicationyml参数">#</a> 2. 配置 application.yml 参数</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8036</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">datasource:</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">****</span><br>    <span class="hljs-attr">password:</span>  <span class="hljs-string">****</span><br>    <span class="hljs-attr">url:</span>  <span class="hljs-string">****</span><br>    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">com.mysql.cj.jdbc.MysqlConnectionPoolDataSource</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">hospital-file</span><br>  <span class="hljs-attr">thymeleaf:</span><br>    <span class="hljs-attr">cache:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">servlet:</span><br>    <span class="hljs-attr">multipart:</span><br>      <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span> <span class="hljs-comment">#开启 multipart 上传功能</span><br>      <span class="hljs-attr">max-file-size:</span> <span class="hljs-string">500MB</span><br>      <span class="hljs-attr">file-size-threshold:</span> <span class="hljs-string">2KB</span><br>      <span class="hljs-attr">max-request-size:</span> <span class="hljs-string">1024MB</span><br><span class="hljs-attr">mybatis-plus:</span> <br>  <span class="hljs-attr">mapper-locations:</span> <span class="hljs-string">classpath*:mybatis/*.xml</span><br><span class="hljs-attr">file:</span><br>  <span class="hljs-attr">locations:</span> <span class="hljs-string">D:/home/</span><br><br></code></pre></td></tr></table></figure><p class="note note-primary">其中file.upload.path =D:/aplus参数为自定义的参数，有两种方式可以获取到此参数</p><ul><li>使用 @Value (&quot;${file.upload.path}&quot;)</li><li>使配置参数可以自动绑定到 POJO 类。</li></ul><p class="note note-primary">使配置参数绑定实体类详细代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 配置信息</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> fengbo</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@ConfigurationProperties(prefix = &quot;file&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileProperty</span> &#123;<br><br>    <span class="hljs-keyword">private</span> String filePath;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getFilePath</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> filePath;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setFilePath</span><span class="hljs-params">(String filePath)</span> &#123;<br>        <span class="hljs-built_in">this</span>.filePath = filePath;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p class="note note-primary">必须在@SpringbootUploadApplication注解的类中添加@EnableConfigurationProperties注解以开启ConfigurationProperties功能</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@EnableConfigurationProperties(&#123;</span><br><span class="hljs-meta">        FileProperty.class</span><br><span class="hljs-meta">&#125;)</span><br><span class="hljs-comment">//@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)</span><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileApplication</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SpringApplication.run(FileApplication.class, args);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h5 id="3实体响应类和异常信息类"><a class="markdownIt-Anchor" href="#3实体响应类和异常信息类">#</a> 3. 实体响应类和异常信息类</h5><p class="note note-primary">文件成功后需要有的响应实体类UploadFileResponse和文件出现上传异常类FileException来处理异常信息</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 文件管理表</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> fengbo</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@ApiModel(value=&quot;文件管理表&quot;)</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@Builder</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-meta">@NoArgsConstructor</span><br><span class="hljs-meta">@TableName(value = &quot;sys_file&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SysFileDto</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 主键id</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableId(value = &quot;id&quot;, type = IdType.INPUT)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;主键id&quot;)</span><br>    <span class="hljs-keyword">private</span> String id;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 文件名称</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;file_name&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;文件名称&quot;)</span><br>    <span class="hljs-keyword">private</span> String fileName;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 文件类型</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;file_type&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;文件类型&quot;)</span><br>    <span class="hljs-keyword">private</span> String fileType;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 文件大小</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;file_size&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;文件大小&quot;)</span><br>    <span class="hljs-keyword">private</span> Long fileSize;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 保存名称</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;save_name&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;保存名称&quot;)</span><br>    <span class="hljs-keyword">private</span> String saveName;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 保存路径</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;save_path&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;保存路径&quot;)</span><br>    <span class="hljs-keyword">private</span> String savePath;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 下载路径</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;download_path&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;下载路径&quot;)</span><br>    <span class="hljs-keyword">private</span> String downloadPath;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 删除标识</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;`valid`&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;删除标识&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer valid;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 创建时间</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;create_at&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;创建时间&quot;)</span><br>    <span class="hljs-keyword">private</span> Long createAt;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 修改时间</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;update_at&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;修改时间&quot;)</span><br>    <span class="hljs-keyword">private</span> Long updateAt;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 容器名称</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;bucket_name&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;容器名称&quot;)</span><br>    <span class="hljs-keyword">private</span> String bucketName;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 用户所属系统</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;solution_code&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;用户所属系统&quot;)</span><br>    <span class="hljs-keyword">private</span> String solutionCode;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 用户id</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;user_id&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;用户id&quot;)</span><br>    <span class="hljs-keyword">private</span> String userId;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 文件后缀</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(value = &quot;suffix&quot;)</span><br>    <span class="hljs-meta">@ApiModelProperty(value=&quot;文件后缀&quot;)</span><br>    <span class="hljs-keyword">private</span> String suffix;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SysFileDto</span><span class="hljs-params">(String fileName, String downloadPath, String fileType,</span><br><span class="hljs-params">                      <span class="hljs-type">long</span> fileSize, String suffix,String userId,String solutionCode,</span><br><span class="hljs-params">                      Long updateAt,Long createAt,Integer valid,String savePath,String saveName,String id)</span> &#123;<br>        <span class="hljs-built_in">this</span>.fileName = fileName;<br>        <span class="hljs-built_in">this</span>.userId = userId;<br>        <span class="hljs-built_in">this</span>.solutionCode = solutionCode;<br>        <span class="hljs-built_in">this</span>.updateAt = updateAt;<br>        <span class="hljs-built_in">this</span>.createAt = createAt;<br>        <span class="hljs-built_in">this</span>.valid = valid;<br>        <span class="hljs-built_in">this</span>.savePath = savePath;<br>        <span class="hljs-built_in">this</span>.id = id;<br>        <span class="hljs-built_in">this</span>.saveName = saveName;<br>        <span class="hljs-built_in">this</span>.suffix = suffix;<br>        <span class="hljs-built_in">this</span>.downloadPath = downloadPath;<br>        <span class="hljs-built_in">this</span>.fileType = fileType;<br>        <span class="hljs-built_in">this</span>.fileSize = fileSize;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SysFileDto</span><span class="hljs-params">(String fileName, String downloadPath, String fileType, <span class="hljs-type">long</span> fileSize)</span> &#123;<br>        <span class="hljs-built_in">this</span>.fileName = fileName;<br>        <span class="hljs-built_in">this</span>.downloadPath = downloadPath;<br>        <span class="hljs-built_in">this</span>.fileType = fileType;<br>        <span class="hljs-built_in">this</span>.fileSize = fileSize;<br>    &#125;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_ID</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;id&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_FILE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;file_name&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_FILE_TYPE</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;file_type&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_FILE_SIZE</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;file_size&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_SAVE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;save_name&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_SAVE_PATH</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;save_path&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_DOWNLOAD_PATH</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;download_path&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_VALID</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;valid&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_CREATE_AT</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;create_at&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_UPDATE_AT</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;update_at&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_BUCKET_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;bucket_name&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_SOLUTION_CODE</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;solution_code&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_USER_ID</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;user_id&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COL_SUFFIX</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;suffix&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p class="note note-primary">异常信息处理类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> fengbo</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Title</span>: FileException</span><br><span class="hljs-comment"> * 异常信息配置</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RuntimeException</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">FileException</span><span class="hljs-params">(String message)</span> &#123;<br>        <span class="hljs-built_in">super</span>(message);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">FileException</span><span class="hljs-params">(String message, Throwable cause)</span> &#123;<br>        <span class="hljs-built_in">super</span>(message, cause);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="4创建filecontroller"><a class="markdownIt-Anchor" href="#4创建filecontroller">#</a> 4. 创建 FileController</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 文件上传下载</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> fengbo</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Api(tags = &quot;文件管理&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> FileService fileService;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 单文件上传</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> file</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@PostMapping(&quot;/uploadFile&quot;)</span><br>    <span class="hljs-keyword">public</span> SysFileDto <span class="hljs-title function_">uploadFile</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;file&quot;)</span> MultipartFile file)</span> &#123;<br>        <span class="hljs-keyword">return</span> fileService.uploadFile(file);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 多文件上传</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> files</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@PostMapping(&quot;/uploadMultipleFiles&quot;)</span><br>    <span class="hljs-keyword">public</span> List&lt;SysFileDto&gt; <span class="hljs-title function_">uploadMultipleFiles</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;files&quot;)</span> MultipartFile[] files)</span> &#123;<br>        <span class="hljs-keyword">return</span> fileService.uploadMultiple(files);<br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 下载</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> fileName</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> request</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@GetMapping(&quot;/downloadFile/&#123;fileName:.*&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> ResponseEntity&lt;Resource&gt; <span class="hljs-title function_">downloadFile</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String fileName, HttpServletRequest request)</span> &#123;<br>        <span class="hljs-keyword">return</span> fileService.download(fileName, request);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p class="note note-primary">FileService实现类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 文件管理</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> fengbo</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Service</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileServiceImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ServiceImpl</span>&lt;FileMapper, SysFileDto&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FileService</span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(FileServiceImpl.class);<br><br>    <span class="hljs-keyword">private</span> Path fileStorageLocation; <span class="hljs-comment">// 文件在本地存储的地址</span><br>    <span class="hljs-meta">@Autowired</span><br>    FileMapper fileMapper;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">FileServiceImpl</span><span class="hljs-params">( <span class="hljs-meta">@Value(&quot;$&#123;file.locations&#125;&quot;)</span> String path)</span> &#123;<br>        <span class="hljs-built_in">this</span>.fileStorageLocation = Paths.get(path).toAbsolutePath().normalize();<br>        <span class="hljs-keyword">try</span> &#123;<br>            Files.createDirectories(<span class="hljs-built_in">this</span>.fileStorageLocation);<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileException</span>(<span class="hljs-string">&quot;Could not create the directory&quot;</span>, e);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 存储文件到系统</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> file 文件</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> 文件名</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">storeFile</span><span class="hljs-params">(MultipartFile file)</span> &#123;<br>        <span class="hljs-comment">// Normalize file name</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">fileName</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString()+file.getOriginalFilename().substring(file.getOriginalFilename().lastIndexOf(<span class="hljs-string">&quot;.&quot;</span>),file.getOriginalFilename().length());<br><span class="hljs-comment">//        String fileName = StringUtils.cleanPath(file.getOriginalFilename());</span><br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// Check if the file&#x27;s name contains invalid characters</span><br>            <span class="hljs-keyword">if</span>(fileName.contains(<span class="hljs-string">&quot;..&quot;</span>)) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileException</span>(<span class="hljs-string">&quot;Sorry! Filename contains invalid path sequence &quot;</span> + fileName);<br>            &#125;<br><br>            <span class="hljs-comment">// Copy file to the target location (Replacing existing file with the same name)</span><br>            <span class="hljs-type">Path</span> <span class="hljs-variable">targetLocation</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.fileStorageLocation.resolve(fileName);<br>            Files.copy(file.getInputStream(), targetLocation, StandardCopyOption.REPLACE_EXISTING);<br><br>            <span class="hljs-keyword">return</span> fileName;<br>        &#125; <span class="hljs-keyword">catch</span> (IOException ex) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileException</span>(<span class="hljs-string">&quot;Could not store file &quot;</span> + fileName + <span class="hljs-string">&quot;. Please try again!&quot;</span>, ex);<br>        &#125;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Resource <span class="hljs-title function_">loadFileAsResource</span><span class="hljs-params">(String fileName)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Path</span> <span class="hljs-variable">filePath</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.fileStorageLocation.resolve(fileName).normalize();<br>            <span class="hljs-type">Resource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UrlResource</span>(filePath.toUri());<br>            <span class="hljs-keyword">if</span>(resource.exists()) &#123;<br>                <span class="hljs-keyword">return</span> resource;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileException</span>(<span class="hljs-string">&quot;File not found &quot;</span> + fileName);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (MalformedURLException ex) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileException</span>(<span class="hljs-string">&quot;File not found &quot;</span> + fileName, ex);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 单文件上传</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> file</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> SysFileDto <span class="hljs-title function_">uploadFile</span><span class="hljs-params">(MultipartFile file)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">fileName</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.storeFile(file);<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">fileDownloadUri</span> <span class="hljs-operator">=</span> ServletUriComponentsBuilder.fromCurrentContextPath()<br>                .path(<span class="hljs-string">&quot;/downloadFile/&quot;</span>)<br>                .path(fileName)<br>                .toUriString();<br>        <span class="hljs-comment">//填充dto</span><br>        <span class="hljs-type">SysFileDto</span> <span class="hljs-variable">sysFileDto</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SysFileDto</span>();<br>        sysFileDto.setFileSize(file.getSize());<br>        sysFileDto.setFileName(fileName);<br>        sysFileDto.setFileType(file.getContentType());<br>        sysFileDto.setDownloadPath(fileDownloadUri);<br>        sysFileDto.setCreateAt(System.currentTimeMillis());<br>        sysFileDto.setUpdateAt(System.currentTimeMillis());<br>        sysFileDto.setId(UUID.randomUUID().toString());<br>        sysFileDto.setSaveName(file.getOriginalFilename().replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;&quot;</span>));<br>        sysFileDto.setUserId(<span class="hljs-string">&quot;测试&quot;</span>);<br>        sysFileDto.setSavePath(fileStorageLocation.toFile().getPath());<br>        <span class="hljs-comment">//默认生效0-生效1-失效</span><br>        sysFileDto.setValid(<span class="hljs-number">0</span>);<br>        sysFileDto.setSuffix(file.getOriginalFilename().substring(file.getOriginalFilename().lastIndexOf(<span class="hljs-string">&quot;.&quot;</span>),file.getOriginalFilename().length()));<br>        <span class="hljs-built_in">this</span>.save(sysFileDto);<br>        <span class="hljs-keyword">return</span> sysFileDto;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 多文件上传</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> files</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> List&lt;SysFileDto&gt; <span class="hljs-title function_">uploadMultiple</span><span class="hljs-params">(MultipartFile[] files)</span>&#123;<br>        List&lt;SysFileDto&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">if</span> (files != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">for</span> (MultipartFile multipartFile:files) &#123;<br>                <span class="hljs-type">SysFileDto</span> <span class="hljs-variable">uploadFileResponse</span> <span class="hljs-operator">=</span> uploadFile(multipartFile);<br>                list.add(uploadFileResponse);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> list;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> ResponseEntity&lt;Resource&gt; <span class="hljs-title function_">download</span><span class="hljs-params">(String fileName, HttpServletRequest request)</span> &#123;<br>        <span class="hljs-type">Resource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.loadFileAsResource(fileName);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">contentType</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            request.getServletContext().getMimeType(resource.getFile().getAbsolutePath());<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            logger.info(<span class="hljs-string">&quot;Could not determine file type.&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(contentType == <span class="hljs-literal">null</span>) &#123;<br>            contentType = <span class="hljs-string">&quot;application/octet-stream&quot;</span>;<br>        &#125;<br><br>        List&lt;String&gt; saveName  = fileMapper.findSaveNameByFileName(fileName);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> saveName.get(<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            name = URLEncoder.encode(name,<span class="hljs-string">&quot;UTF-8&quot;</span>);<br>        &#125;<span class="hljs-keyword">catch</span>(UnsupportedEncodingException e)&#123;<br>            logger.info(<span class="hljs-string">&quot;文件名转换异常&quot;</span>);<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> ResponseEntity.ok()<br>                .contentType(MediaType.parseMediaType(contentType))<br>                .header(HttpHeaders.CONTENT_DISPOSITION, <span class="hljs-string">&quot;attachment; filename=\&quot;&quot;</span> +name+ <span class="hljs-string">&quot;\&quot;&quot;</span>)<br>                .body(resource);<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p>需要注意的是，文件名称中文乱码的问题。这里使用了 <code>URLEncoder.encode();</code></p><p>文件名使用 uuid 生成储存。下载时替换为原文件名下载。</p><p class="note note-primary">mapper文件(只是为了查询文件名称)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.hostpital.file.mapper.FileMapper&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;BaseResultMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.hostpital.file.vo.SysFileVo&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;file_name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;fileName&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;file_type&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;fileType&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;file_size&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;fileSize&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;save_name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;saveName&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;save_path&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;savePath&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;download_path&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;downloadPath&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;valid&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;valid&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;create_at&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;createAt&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;update_at&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;updateAt&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;bucket_name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;bucketName&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;solution_code&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;solutionCode&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;user_id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;userId&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;suffix&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;suffix&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">sql</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;Base_Column_List&quot;</span>&gt;</span><br>        id,<br>        file_name,<br>        file_type,<br>        file_size,<br>        save_name,<br>        save_path,<br>        download_path,<br>        `valid`,<br>        create_at,<br>        update_at,<br>        bucket_name,<br>        solution_code,<br>        user_id,<br>        suffix<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">sql</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;findSaveNameByFileName&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;java.lang.String&quot;</span>&gt;</span><br>        select save_name<br>        from sys_file<br>        where file_name=#&#123;fileName&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br><br></code></pre></td></tr></table></figure><h4 id="二-接口测试"><a class="markdownIt-Anchor" href="#二-接口测试">#</a> 二、接口测试</h4><p><img src="https://cdn.jsdelivr.net/gh/miemieFeng/blogImg/Blogs/20221116201344.png" alt="20221116201344"></p>]]></content>
    
    
    <categories>
      
      <category>java</category>
      
      <category>springboot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>springboot</tag>
      
      <tag>后端</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>英雄联盟美测服汉化</title>
    <link href="/%E8%8B%B1%E9%9B%84%E8%81%94%E7%9B%9F%E7%BE%8E%E6%B5%8B%E6%9C%8D%E6%B1%89%E5%8C%96/"/>
    <url>/%E8%8B%B1%E9%9B%84%E8%81%94%E7%9B%9F%E7%BE%8E%E6%B5%8B%E6%9C%8D%E6%B1%89%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<p>第一步：首先第一步我们进入到 PBE 的原始文件夹里，找到 LOLPBE 的打开程序，然后右键发送桌面快捷方式</p><p>第二步：我们到桌面 右键属性 打开快捷方式</p><p>第三步，我们在目标后面添加：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">--locale</span>=zh_CN <br></code></pre></td></tr></table></figure><p>记住加个空格</p><p class="note note-primary">更改完成后会重新下载一些东西</p>]]></content>
    
    
    <categories>
      
      <category>lol</category>
      
      <category>pbe</category>
      
      <category>game</category>
      
    </categories>
    
    
    <tags>
      
      <tag>game</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>博客上云小记</title>
    <link href="/%E5%8D%9A%E5%AE%A2%E4%B8%8A%E4%BA%91%E5%B0%8F%E8%AE%B0/"/>
    <url>/%E5%8D%9A%E5%AE%A2%E4%B8%8A%E4%BA%91%E5%B0%8F%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h3 id="一-服务器和域名"><a class="markdownIt-Anchor" href="#一-服务器和域名">#</a> 一、服务器和域名</h3><ul><li>腾讯云轻量级服务器</li><li>腾讯云域名</li></ul><p>服务器系统  <code>  Centos7</code></p><h5 id="1-配置nginx"><a class="markdownIt-Anchor" href="#1-配置nginx">#</a> 1、配置 <code>nginx</code></h5><p>使用云命令安装</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">yum <span class="hljs-keyword">install</span> -y nginx<br></code></pre></td></tr></table></figure><p>启动服务器</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-params">system</span>ctl start nginx<br><span class="hljs-params">system</span>ctl enable nginx<br></code></pre></td></tr></table></figure><h5 id="2-配置服务器路由"><a class="markdownIt-Anchor" href="#2-配置服务器路由">#</a> 2、配置服务器路由</h5><p>安装并启动服务器后，我们就完成了第一步，现在我们可以尝试使用自己的电脑去访问服务器的公网 IP。可以发现，公网 IP 可以打开一个 nginx 的默认网页。这样，我们就成功了第一步。</p><p>但我们实际上是想要让这个地址指向我们的博客，而不是 nginx 的默认网址，这就需要我们去配置 nginx 的配置文件。很多关于 centOS 的资料都是说配置位于 etc/nginx/conf.d/ 下的 dafault.conf 这个配置文件，但腾讯云和阿里云默认的库下载的是 fedora 版本的 nginx，我们应该配置的是位于 etc/nginx/ 下的 nginx.conf 。</p><p>打开 <code>/etc/nginx/</code>  目录下的 <code>nginx.conf</code>  文件 <code>vi /etc/nginx/nginx.conf</code></p><p>按 i 键进入编辑模式，编辑完成后按 Esc 键退出编辑模式，依次按 ：wq 保存并退出，注意是先按：键，然后输入 wq 再按回车</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span> default_server;<br>        <span class="hljs-attribute">listen</span>       [::]:<span class="hljs-number">80</span> default_server;<br>        <span class="hljs-attribute">server_name</span>  _;   <span class="hljs-comment">#把server_name后面的_换为自己的域名，没有域名可以先填公网ip</span><br>        <span class="hljs-attribute">root</span>         /home/hexo;       <span class="hljs-comment">#root后面改为git仓库目录</span><br>    <span class="hljs-comment"># Load configuration files for the default server block.</span><br>    <span class="hljs-attribute">include</span> /etc/nginx/default.d/<span class="hljs-regexp">*.conf</span>;<br><br>    <span class="hljs-section">location</span> / &#123;<br>    &#125;<br></code></pre></td></tr></table></figure><h5 id="3-安装git"><a class="markdownIt-Anchor" href="#3-安装git">#</a> 3、安装 git</h5><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">yum <span class="hljs-keyword">install</span> git<br></code></pre></td></tr></table></figure><p>配置 git 用户</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">adduser git</span><br></code></pre></td></tr></table></figure><p>修改用户权限:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">chmod <span class="hljs-number">740</span> <span class="hljs-regexp">/etc/</span>sudoers<br>vi <span class="hljs-regexp">/etc/</span>sudoers<br></code></pre></td></tr></table></figure><p>按向下键在文件中找到字段</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">root    <span class="hljs-keyword">ALL</span>=(<span class="hljs-keyword">ALL</span>)       <span class="hljs-keyword">ALL</span><br></code></pre></td></tr></table></figure><p>按 i 进入编辑模式，在这一句下面加上一句</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">git     <span class="hljs-keyword">ALL</span>=(<span class="hljs-keyword">ALL</span>)       <span class="hljs-keyword">ALL</span><br></code></pre></td></tr></table></figure><p>按 Esc 退出编辑，再按:wq 回车保存退出后，然后将 sudoers 文件权限改回原样</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">chmod <span class="hljs-number">400</span> <span class="hljs-regexp">/etc/</span>sudoers<br></code></pre></td></tr></table></figure><p>设置 git 用户的密码</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">sudo passwd git</span><br></code></pre></td></tr></table></figure><p>注意 git 用户的密码要在 root 用户下修改，否则会提示权限不足。下面操作也是一样，要注意是在 git 用户还是 root 用户</p><p>切换到 git 用户，然后在～目录下创建.ssh 文件夹</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">su git<br><span class="hljs-keyword">cd</span> ~<br>mkdir <span class="hljs-string">.ssh</span><br><span class="hljs-keyword">cd</span> <span class="hljs-string">.ssh</span><br></code></pre></td></tr></table></figure><p>生成公钥密钥文件</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">ssh-keygen</span><br></code></pre></td></tr></table></figure><p>此时在目录下就会有两个文件，分别是</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">id_rsa</span> 和 id_rsa.pub<br></code></pre></td></tr></table></figure><p>其中  <code>id_rsa.pub</code>  就是公钥文件，我们把它复制一份</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-keyword">cp</span> id_rsa.pub authorized_keys<br></code></pre></td></tr></table></figure><p>这样目录下就会有一个 authorized_keys 文件</p><p>然后我们修改它的权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> 755 ~<br><span class="hljs-built_in">chmod</span> 700 ~/.ssh<br><span class="hljs-built_in">chmod</span> 600 ~/.ssh/authorized_keys<br></code></pre></td></tr></table></figure><p>这样我们就可以在自己的电脑上打开 cmd，使用 ssh 方式连接我们的云服务器</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">ssh -v git<span class="hljs-meta">@公网ip</span>    <span class="hljs-comment">#@后面输入云服务器公网ip</span><br></code></pre></td></tr></table></figure><p>输入密码，就能成功登录服务器</p><p>接着我们创建一个 git 的仓库，并且新建一个 post-receive 文件，用来把提交到服务器仓库操作如下:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">su root<br><span class="hljs-built_in">cd</span> /home/git<br>git init --bare blog.git  <span class="hljs-comment">#在/home/git下创建新仓库blog.git</span><br><span class="hljs-built_in">chown</span> git:git -R blog.git <span class="hljs-comment">#给予git用户权限</span><br></code></pre></td></tr></table></figure><p>在  <code>/home/hexo/blog.git</code>  下，有一个自动生成的  <code>hooks</code>  文件夹，我们创建一个  <code>post-receive</code>  钩子，把提交到 <code>/home/git/blog.git</code>  仓库里的文件同步到 <code>/home/hexo</code>  中。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> blog.git/hooks<br>vim post-receive<br></code></pre></td></tr></table></figure><p>在 <code>post-receive</code>  中输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash </span><br> git --work-tree=/home/hexo --git-dir=/home/git/blog.git checkout -f<br></code></pre></td></tr></table></figure><p>保存退出后授予该文件可执行权限</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">chmod +x <span class="hljs-regexp">/home/gi</span>t<span class="hljs-regexp">/blog.git/</span>hooks/post-receive<br></code></pre></td></tr></table></figure><h3 id="二-关于本地主机的操作"><a class="markdownIt-Anchor" href="#二-关于本地主机的操作">#</a> 二、关于本地主机的操作</h3><h4 id="1-安裝hexo"><a class="markdownIt-Anchor" href="#1-安裝hexo">#</a> 1、安裝 hexo</h4><p>由于使用 npm 直接下载会有很多人遇到卡顿的问题 (国外服务器)，所以我们要做的第一步工作是将 npm 换成淘宝的服务器。cmd 输入下面的命令：</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs tcl">npm config <span class="hljs-keyword">set</span> <span class="hljs-keyword">registry</span> https://<span class="hljs-keyword">registry</span>.npm.taobao.org<br><span class="hljs-comment"># 然后安装cnpm</span><br>npm install -g cnpm --<span class="hljs-keyword">registry</span>=https://<span class="hljs-keyword">registry</span>.npm.taobao.org<br></code></pre></td></tr></table></figure><p>接下来就直接安装 hexo</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">cnpm install -g hexo-<span class="hljs-keyword">cli</span><br></code></pre></td></tr></table></figure><p>然后我们选一个目录用来初始化博客<br>例如 D:/Blog</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">D:</span><br>cd Blog<br>hexo init<br></code></pre></td></tr></table></figure><p>执行成功后安装两个插件</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmake">npm <span class="hljs-keyword">install</span> hexo-deployer-git --save<br>npm <span class="hljs-keyword">install</span> hexo-server<br></code></pre></td></tr></table></figure><p>之后我们就可以在自己的本机上查看自己的博客了</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">hexo g</span><br><span class="hljs-attribute">hexo s</span><br></code></pre></td></tr></table></figure><h4 id="2-配置服務"><a class="markdownIt-Anchor" href="#2-配置服務">#</a> 2、配置服務</h4><p>在刚才生成博客的目录下，找到 <code>_config.yml</code> ，打开它。</p><p>找到 deploy 做如下配置，注意 deploy：下面几行一定要缩进两格</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">deploy:</span><br><span class="hljs-symbol">  type:</span> git<br><span class="hljs-symbol">  repo:</span> root@服务器仓库位置   <span class="hljs-meta">#@后输入 服务器公网IP:/home/git/blog.git       </span><br><span class="hljs-symbol">branch:</span> master <br></code></pre></td></tr></table></figure><p>保存退出</p><p>在服务器上重新运行 nginx 服务器<br> <code>nginx -s reload</code></p><p>注意每次修改配置文件按后都要重启 nginx 使之生效</p><p>然后尝试写一篇文章并且发布到服务器上</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs verilog">hexo <span class="hljs-keyword">new</span> <span class="hljs-string">&quot;Hello My First Blog&quot;</span><br>hexo clean &amp;&amp; hexo <span class="hljs-keyword">generate</span> --deploy<br></code></pre></td></tr></table></figure><p>打开本地博客目录，会发现 deploy_git 目录下有了 Hello My First Blog 文件夹，里面是个简单的 index.html 文件。</p><p>在服务器的 home/hexo/2020/12/17 目录下可以发现也有个 Hello My First Blog 文件，这说明文件上传成功。</p>]]></content>
    
    
    <categories>
      
      <category>hexo</category>
      
      <category>blog</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
